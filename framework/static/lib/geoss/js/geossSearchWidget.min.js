var MyWorkspace={addSavedSearch:function(){var e=searchFormAttributes;GeossUtil.isAnyFilterSelected()&&Liferay.Service("/geoss-service-portlet.savedsearch/add-saved-search",{name:e.name,popularSearchId:e.popularSearchId,query:e.query,fullAndOpenDataset:e.fullAndOpenDataset.value,dateFrom:e.dateFrom,dateTo:e.dateTo,datePeriod:e.datePeriod.value,aoiOption:e.aoiOption.value,aoiBoundingBox:e.aoiBoundingBox,aoiGeolocation:e.aoiGeolocation,aoiW3W:e.aoiW3W,aoiRelation:e.aoiRelation.value,cloudCoverageFrom:e.cloudCoverageFrom.value,cloudCoverageTo:e.cloudCoverageTo.value,queryParams:e.queryParams.value,folder:e.folder.value,filterParams:e.filterParams.value,filterSet:e.filterSet,currMap:e.currMap},function(t){t.id?(MyWorkspace.showMessage("SAVE SEARCH","Your search has been saved in My Workspace -> Your saved searches."),LogStore.logSearchResult(e,"Search saved in My Workspace")):MyWorkspace.showMessage("SAVE SEARCH","Failed to save search.")})},restoreMainSearch:function(){MyWorkspace.Search.query&&($("#searchChosen").length?$("#searchChosen").val(MyWorkspace.Search.query):$(".search-input input").val(MyWorkspace.Search.query)),MyWorkspace.Search.fullAndOpenDataset&&$("label[for='Full_and_Open_Dataset']").trigger("click");for(var e=0;e<MyWorkspace.Search.customFields.length;e++)MyWorkspace.setCustomFieldValue(e);if(MyWorkspace.Search.datePeriod?$("label[for='"+MyWorkspace.Search.datePeriod+"']").trigger("click"):(MyWorkspace.Search.dateFrom&&($("#date-from").val(MyWorkspace.Search.dateFrom),$("#date-from").trigger("focus"),$("#date-from").trigger("blur")),MyWorkspace.Search.dateTo&&($("#date-to").val(MyWorkspace.Search.dateTo),$("#date-to").trigger("focus"),$("#date-to").trigger("blur"))),$("label[for='"+MyWorkspace.Search.aoiRelation+"']").trigger("click"),MyWorkspace.Search.aoiOption&&($(".search-option-select input[value='"+MyWorkspace.Search.aoiOption+"']").parent("label").trigger("click"),$(".search-option-select").trigger("click")),"Coordinates"==MyWorkspace.Search.aoiOption){if(MyWorkspace.Search.aoiBoundingBox){var t=parseCoordinates(MyWorkspace.Search.aoiBoundingBox);$("#FirstLongiutde").val(t[0]),$("#FirstLatitude").val(t[1]),$("#SecondLongiutde").val(t[2]),$("#SecondLatitude").val(t[3]),$("#FirstLongiutde").trigger("input")}}else if("Geolocation"==MyWorkspace.Search.aoiOption){$(".row-form-search #geolocation_search").val(MyWorkspace.Search.aoiGeolocation);var a=(t=parseCoordinates(MyWorkspace.Search.aoiBoundingBox))[0],i=t[1],r=t[2],s=t[3];GeossUtil.setChosenGeolocation(a,i,r,s)}else"ContinentAndCountry"==MyWorkspace.Search.aoiOption?$(".country-select input[value='"+MyWorkspace.Search.aoiBoundingBox+"']").parent("label").trigger("click"):"What3Words"==MyWorkspace.Search.aoiOption&&($(".row-form-search #w3w_search").val(MyWorkspace.Search.aoiW3W),GeossUtil.setChosenW3W(MyWorkspace.Search.aoiW3W));MyWorkspace.Search.defaultSearch||(hideAllTooltips(),$(".search-button-2 span").trigger("click"))},restoreGranulaSearch:function(){$(".results-icons button.info[value='"+MyWorkspace.Search.folder+"']").siblings("button.drill-down").trigger("click")},addBookmarkedResult:function(e){var t=e.closest(".result-text").find(".result-title").text(),a=e.closest(".list-result").data("target-id"),i=e.closest(".list-result").data("entry-xml"),r=DAB.View.generateCurrentMapName(),s=e.closest(".result-text").find(".resultboxtext span").html(),l=e.closest(".results-icons").find(".info").attr("value");Liferay.Service("/geoss-service-portlet.bookmarkedresult/add-bookmarked-result",{name:t,targetId:a,entryXml:i,currMap:r},function(i){"object"==typeof i?(MyWorkspace.BookmarkedResults.push(a),MyWorkspace.showMessage("BOOKMARK RESULT","Result has been saved in My Workspace -> Bookmarked Results."),e.addClass("remove"),e.removeClass("add"),e.prop("title","Remove from bookmarks"),LogStore.logElementClick(null,null,l,null,"Bookmark saved in My Workspace",null,s,t)):MyWorkspace.showMessage("BOOKMARK RESULT","Failed to bookmark result.")})},deleteBookmarkedResult:function(e){var t=e.closest(".list-result").data("target-id"),a=e.closest(".result-text").find(".resultboxtext span").html(),r=e.closest(".result-text").find(".result-title").html(),s=e.closest(".results-icons").find(".info").attr("value");Liferay.Service("/geoss-service-portlet.bookmarkedresult/delete-bookmarked-result",{targetId:t},function(l){if("object"==typeof l){for(i=MyWorkspace.BookmarkedResults.length;i>=0;i--)t==MyWorkspace.BookmarkedResults[i]&&MyWorkspace.BookmarkedResults.splice(i,1);MyWorkspace.showMessage("BOOKMARK RESULT","Result has been removed from bookmarks."),e.addClass("add"),e.removeClass("remove"),e.prop("title","Add as bookmark"),LogStore.logElementClick(null,null,s,null,"Bookmark removed from My Workspace",null,a,r)}else MyWorkspace.showMessage("BOOKMARK RESULT","Failed to remove result from bookmarks.")})},restoreBookmarkedResult:function(){MyWorkspace.Bookmark.feed&&(hideAllTooltips(),$(".search-input #searchForm input").val(MyWorkspace.Bookmark.name),$(".search-button-2 span").trigger("click"))},drillUpBookmarkedResult:function(){MyWorkspace.resetSearchCount(),MyWorkspace.Bookmark.drillDown=!1,MyWorkspace.restoreBookmarkedResult()},restoreDrillDownBookmark:function(){$(".results-icons button.info").siblings("button.drill-down").trigger("click")},getToday:function(){var e=new Date,t=e.getDate(),a=e.getMonth()+1,i=e.getFullYear(),r=e.getHours(),s=e.getMinutes();return t<10&&(t="0"+t),a<10&&(a="0"+a),s<10&&(s="0"+s),e=t+"-"+a+"-"+i+" "+r+":"+s},isNumber:function(e){return null!=e&&""!=e&&""!=e.trim()&&!isNaN(parseFloat(e))},Search:{savedSearchId:0,popularSearchId:0,query:null,showFullAndOpenDataset:!1,fullAndOpenDataset:!1,showDate:!1,dateFrom:null,dateTo:null,datePeriod:null,showAoi:!1,aoiOption:null,aoiBoundingBox:null,aoiGeolocation:null,aoiW3W:null,aoiRelation:null,showClaudCoverage:!1,cloudCoverageFrom:0,cloudCoverageTo:0,defaultSearch:!1,folder:null,currMap:null,filterSet:null,filterParams:[],customFields:[]},Bookmark:{targetIds:"",name:null,feed:null,drillDown:!1,currMap:null},BookmarkedResults:[],Settings:{settingsDhusUsername:null},Location:{longitude:15,latitude:30},searchCount:0,incSearchCount:function(){MyWorkspace.searchCount++},resetSearchCount:function(){MyWorkspace.searchCount=0},isRestoredSearch:function(){return MyWorkspace.searchCount<=1&&!MyWorkspace.Search.defaultSearch},isRestoredGranulaSearch:function(){return!(!MyWorkspace.isRestoredSearch()||!MyWorkspace.Search.folder)},showMessage:function(e,t){$(".black:visible").find(".close-popup").trigger("click"),$(".black.saved3").find(".title").text(e),$(".black.saved3").find(".title-mode").html(t),$(".black.saved3").show(),$(".black.saved3 .button_saved").focus()},isRestoredBookmark:function(){return!!(MyWorkspace.searchCount<=1&&MyWorkspace.Bookmark.feed)},isRestoredDrillDownBookmark:function(){return!(!MyWorkspace.isRestoredBookmark()||!MyWorkspace.Bookmark.drillDown)},queryBookmarkFeed:function(e){var t=MyWorkspace.Bookmark.feed,a=$.get(t,function(t){resultSet=a,e(a,successResponse,failureResponse)})},mailTo:function(e){window.location="mailto:"+e+"@geosec.org"},isCustomFieldSelect:function(e){var t=MyWorkspace.Search.customFields[e];return"PREDEFINED_SELECT"==t.fieldType||"PREDEFINED_MULTISELECT"==t.fieldType},getCustomFieldParamName:function(e){return MyWorkspace.Search.customFields[e].paramName},getCustomFieldFieldName:function(e){return MyWorkspace.Search.customFields[e].fieldName},getCustomFieldValue:function(e){var t=MyWorkspace.Search.customFields[e];if("PREDEFINED_SELECT"==t.fieldType||"PREDEFINED_MULTISELECT"==t.fieldType){var a="";if($(".row-form-search ."+t.fieldName+" .active input").each(function(){a=a?a+","+$(this).attr("value"):$(this).attr("value")}),a!=t.fieldLabel)return a}return""},setCustomFieldValue:function(e){var t=MyWorkspace.Search.customFields[e];if(("PREDEFINED_SELECT"==t.fieldType||"PREDEFINED_MULTISELECT"==t.fieldType)&&t.paramValue){var a=t.paramValue.split(",");for(i=0;i<a.length;i++)$("."+t.fieldName+" input[value='"+a[i]+"']").parent("label").trigger("click")}}},SearchEngine={name:"",addConfig:function(e,t){this[e]=t},getConfig:function(e){return this[e]}},GWP=!1,DAB=DAB||{};$.ajaxSetup({timeout:3e4}),DAB.Client={elasticsearch_response:void 0,temp_xhr:void 0,reqID:void 0,query_search_url:void 0,baseUrl:GWP?SearchEngine.getConfig("dabBaseUrl"):"https://geossdevel.ospartner.pl",openSearchUrl:"/opensearch",openSearchEnhanced:"/opensearchsemanticenhanced",resultSet:"",lastRequest:"",getMetadata:function(e,t){var a=DAB.Client.baseUrl+"/cswisogeo?service=CSW&request=GetRecordById&id="+encodeURIComponent(e)+"&outputschema=http://www.isotc211.org/2005/gmi&elementSetName=full";xhr=$.get(a,function(a){t(xhr,e)}).fail(function(){t(xhr,e)})},callWs:function(e,t,a,i,r){t+=e.params(),console.log("calling: "+t),DAB.Client.query_search_url=t,LogStore.ga_category="discovery",queryId=LogStore.logSearchResult(searchFormAttributes,"search_query");var s;lastRequest=e,s=$.get(t,function(e){resultSet=s,a(s,i,r)}).fail(function(){r("ajax")}),DAB.Client.temp_xhr=s},callOpenSearch:function(e,t,a,i){DAB.Client.baseUrl,DAB.Client.openSearchUrl;DAB.Client.callWs(e,DAB.Client.baseUrl+DAB.Client.openSearchUrl,t,a,i)},Request:function(){console.log("Request instance created");var e=new Map;this.params=function(){var t="?";return e.forEach(function(e,a,i){t=t.concat(a+"="+e+"&")}),t},this.setParameter=function(t,a){return e.set(t,a),this},this.getParameter=function(t){return e.get(t)},this.removeParameter=function(t){return e.delete(t),this},this.setDefaults=function(){return e.set("searchFields","title,keywords"),DAB.Client.reqID=Math.random().toString(36).substring(2),e.set("reqID",DAB.Client.reqID),e.set("si","1"),e.set("ct","10"),e.set("tf","keyword,format,protocol,providerID,organisationName"),e.set("ts",""),e.set("te",""),this}},SimpleXmlRequest:function(e){console.log("SimpleXmlRequest instance created");var t=new DAB.Client.Request;t.setDefaults().setParameter("st",e),this.params=function(){return t.params()},this.setQuery=function(e){t.parameters.set("st",e)},this.request=function(){return t},this.setFacetedCriteria=function(e,a){t.setFacetedCriteria(e,a)}},FacetedSimpleXmlRequest:function(e,t,a){console.log("FacetedSimpleXmlRequest instance created");var i=new DAB.Client.Request;i.setDefaults().setParameter("st",e),i.setFacetedCriteria(t,a),this.params=function(){return i.params()},this.setQuery=function(e){i.parameters.set("st",e)}},SingleResultXmlRequest:function(e){console.log("SingleResultXmlRequest instance created");var t=new DAB.Client.Request;t.setParameter("targetId",e),this.params=function(){return t.params()},this.request=function(){return t}},GranulaSimpleXmlRequest:function(e){console.log("FacetedSimpleXmlRequest instance created");var t=new DAB.Client.Request;t.setParameter("parents",e),this.params=function(){return t.params()}}};var LogStore=LogStore||{};(LogStore={portalLogIndice:"geoss_index",portalLogType:"geoss_data",client:void 0,elasticsearch_live:!1,ga_category:void 0,logSearchResult:function(e,t,a,i,r,s,l){try{var o;if(LogStore.client||(LogStore.elasticsearch_live=LogStore.createElastiSearchClient()),LogStore.elasticsearch_live){var n=null,c=null,d=null,u=null,p=null,m=null,g=null,f=null,h=null,v=null,b=null,x=null,w=null,k=null,y=null,D=null,S=null,B=null,_=null,A=null;"search_query"==t&&(DAB.Client.query_search_url||(DAB.Client.query_search_url=" "),DAB.Client.query_search_url.split("&reqID=").length>1&&(n=DAB.Client.query_search_url.split("&reqID=")[1].split("&")[0],s&&(s="dab")),DAB.Client.query_search_url.split("&si=").length>1&&(c=DAB.Client.query_search_url.split("&si=")[1].split("&")[0]),DAB.Client.query_search_url.split("&ct=").length>1&&(d=DAB.Client.query_search_url.split("&ct=")[1].split("&")[0]),DAB.Client.query_search_url.split("&kwd=").length>1&&(f=DAB.Client.query_search_url.split("&kwd=")[1].split("&")[0]),DAB.Client.query_search_url.split("&sba=").length>1&&(b=DAB.Client.query_search_url.split("&sba=")[1].split("&")[0]),DAB.Client.query_search_url.split("&frmt=").length>1&&(B=DAB.Client.query_search_url.split("&frmt=")[1].split("&")[0]),DAB.Client.query_search_url.split("&prot=").length>1&&(_=DAB.Client.query_search_url.split("&prot=")[1].split("&")[0]),A=DAB.Client.query_search_url);var C=e.aoiGeolocation||e.aoiContinentAndCountry||e.aoiBoundingBox;e.dateFrom&&(u=e.dateFrom+"T00:00:00Z"),e.dateTo&&(p=e.dateTo+"T00:00:00Z"),e.query&&(m=e.query),e.aoiRelation&&(g=e.aoiRelation.label.toUpperCase()),e.folder&&(h=e.folder.value,v=e.folder.label),e.queryParams&&(x=e.queryParams.value.sources,k=e.queryParams.label.sources,w=e.queryParams.value.viewid,y=e.queryParams.label.viewid),e.fullAndOpenDataset&&(D=e.fullAndOpenDataset.value),e.aoiW3W&&(S=e.aoiW3W),GWP&&$(".geoss-header .login-box").html().length>4&&Cookies.get("geoss_email")&&Cookies.get("geoss_email");var M=$(window).width(),T=$(window).height(),O=LogStore.dateInUTCFullYear();logResult=LogStore.client.bulk({body:[{index:{_index:LogStore.portalLogIndice,_type:LogStore.portalLogType}},{session_login:GWP?Liferay.ThemeDisplay.getUserId():null,session_user_email:GWP?Cookies.get("geoss_email"):null,session_id:GWP?Cookies.get("LFR_SESSION_STATE_"+Liferay.ThemeDisplay.getUserId()):null,session_timestamp:Date.now(),session_date:O,ui_object_id:a,ui_object_class:i,ui_source:s,ui_entry_id:r,ui_action:l,ds_query_url:A,ds_reqID:n,ds_si:c,ds_ct:d,ds_ts:u,ds_te:p,ds_st:m,ds_rel:g,ds_kwd:f,ds_parents_group:{key:h,value:v},ds_sba:b,ds_sources_group:{key:x,value:k},ds_views_group:{key:w,value:y},ds_bbox:C,ds_gdc:D,ds_w3w:S,ds_frmt:B,ds_prot:_,win_width:M,win_height:T,operation:t}]},function(e,t){console.log("LogSearch Resp status: "+t.items[0].create.status),201==t.items[0].create.status&&(o=t.items[0].create._id)})}LogStore.ga_category||(LogStore.ga_category="navigation"),GWP&&ga("send","event",{eventCategory:LogStore.ga_category,eventAction:l,eventLabel:a}),LogStore.ga_category=""}catch(e){console.error(e.message)}return o},logResourceError:function(e,t,a,i,r){console.error(a+":"+e+":"+t+":"+i);try{var s,l=LogStore.dateInUTCFullYear();LogStore.client.bulk({body:[{index:{_index:LogStore.portalLogIndice,_type:LogStore.portalLogType}},{session_login:Liferay.ThemeDisplay.getUserId(),session_id:GWP?Cookies.get("LFR_SESSION_STATE_"+Liferay.ThemeDisplay.getUserId()):null,session_timestamp:Date.now(),session_date:l,ui_entry_id:t,result:r,operation:i,message:a}]},function(e,t){console.log("LogSearch Resp status: "+t.items[0].create.status),201==t.items[0].create.status&&(s=t.items[0].create._id)})}catch(e){console.error(e.message)}return s},logElementClick:function(e,t,a,i,r,s,l,o,n){try{var c;if(LogStore.client||(LogStore.elasticsearch_live=LogStore.createElastiSearchClient()),LogStore.elasticsearch_live){var d=null;$(".geoss-header .login-box").html().length>4&&Cookies.get("geoss_email")&&(d=Cookies.get("geoss_email")),l&&(l=l.replace(/\s\s+/g,"")),o&&(o=o.replace(/\s\s+/g,""));var u=$(window).width(),p=$(window).height(),m=LogStore.dateInUTCFullYear();LogStore.client.bulk({body:[{index:{_index:LogStore.portalLogIndice,_type:LogStore.portalLogType}},{session_login:Liferay.ThemeDisplay.getUserId(),session_user_email:d,session_id:Cookies.get("LFR_SESSION_STATE_"+Liferay.ThemeDisplay.getUserId()),session_timestamp:Date.now(),session_date:m,ui_object_id:e,ui_object_class:t,ui_source:i,ui_entry_id:a,ui_action:r,ui_label:s,ui_organisation:l,ui_resource_name:o,operation:n,win_width:u,win_height:p}]},function(e,t){console.log("LogSearch Resp status: "+t.items[0].create.status),201==t.items[0].create.status&&(c=t.items[0].create._id)})}LogStore.ga_category||(LogStore.ga_category="navigation"),GWP&&ga("send","event",{eventCategory:LogStore.ga_category,eventAction:r,eventLabel:e}),LogStore.ga_category=""}catch(e){console.error(e.message)}return c},logSignIn:function(){if(Cookies.get("geoss_justSignedIn")){try{var e,t=LogStore.dateInUTCFullYear();LogStore.client.bulk({body:[{index:{_index:LogStore.portalLogIndice,_type:LogStore.portalLogType}},{session_login:Liferay.ThemeDisplay.getUserId(),session_user_email:Cookies.get("geoss_email"),session_id:Cookies.get("LFR_SESSION_STATE_"+Liferay.ThemeDisplay.getUserId()),session_timestamp:Date.now(),session_date:t,result:"Successfully logged in",operation:"Login attempt"}]},function(t,a){console.log("LogSearch Resp status: "+a.items[0].create.status),201==a.items[0].create.status&&(e=a.items[0].create._id)})}catch(e){console.error(e.message)}return Cookies.remove("geoss_justSignedIn"),e}},getRecentActionsLog:function(e){try{if(LogStore.elasticsearch_live){var t='{"query": {"bool": {"must": {"exists": {"field": "ui_action"}}, "must_not": {"exists": {"field": "ds_reqID"}}, "should": [',a="";for(i=0;i<e.find("id").size();i++)match_str='{"term": {"ui_entry_id": "'+$(e.find("id")[i]).text()+'"}},',a+=match_str;t=(t+=a).replace(/,\s*$/,""),t+='],"minimum_should_match" : 1}}}',LogStore.client.search({size:1e4,index:"geoss_index",body:t},function(e,t){DAB.Client.elasticsearch_response=t,LogStore.updateRecentViews(t)})}}catch(e){console.error(e.message)}},updateRecentViews:function(e){var t,a={};for(i=0;i<DAB.Client.elasticsearch_response.hits.total;i++)a[t=DAB.Client.elasticsearch_response.hits.hits[i]._source.ui_entry_id]?a[t]++:a[t]=1;$.each(a,function(e,t){$(Geoss.resultsContainer+' .result-text .results-icons button.info[value="'+e+'"]').closest(".list-result").find(".nr-views").text(t+" recent views")})},createElasticSearchClient:function(){try{var e,t=window.navigator.userAgent,a=t.indexOf("MSIE "),i=t.indexOf("Trident/");if(a>-1||i>-1){var r=window.location.protocol+"//"+window.location.hostname;window.location.port&&(r=r+":"+window.location.port),e=r+"/logsearch"}else{var s=new URL(window.location.href);e=s.origin+"/logsearch",s.origin.indexOf("localhost")>=0&&(e="https://geossdevel.ospartner.pl/logsearch")}LogStore.client=new $.es.Client({hosts:e}),LogStore.client.ping({requestTimeout:1e4,hello:"elasticsearch"},function(e){e?console.error("LogSearch Cluster is down!"):(console.log("LogSearch Client Created"),LogStore.elasticsearch_live=!0)})}catch(e){console.error(e.message)}return LogStore.elasticsearch_live},dateInUTCFullYear:function(){var e=new Date,t=e.getUTCMonth()+1,a=e.getUTCDate(),i=e.getUTCHours(),r=e.getUTCMinutes(),s=e.getUTCSeconds(),l=e.getUTCMilliseconds();return e.getUTCFullYear()+"-"+((""+t).length<2?"0":"")+t+"-"+((""+a).length<2?"0":"")+a+" "+((""+i).length<2?"0":"")+i+":"+((""+r).length<2?"0":"")+r+":"+((""+s).length<2?"0":"")+s+"."+((""+l).length>2?"":(""+l).length<1?"0":"00")+l}}).elasticsearch_live=LogStore.createElasticSearchClient();var satelliteParamsForRBox,searchFormAttributes={},SATELITE_SEARCH_EMPTY_MSG="Error executing query: No scene DB found for",TITLE_BACKEND_ERROR="BACK END ERROR",MSG_BACKEND_ERROR="A problem occurred when querying the resource provider.<br/>The System Operator has been informed; please try again later on.",TITLE_W3W_ERROR="WRONG W3W FORMAT",MSG_W3W_ERROR="Required format for W3W is word1.word2.word3";DAB.View={gdata:"",scroll_metadate:!1,temp_totalResults:0,temp_startIndex:0,temp_endIndex:0,numberOfOptions:0,drillDownSearch:!1,granulaFiltersEnabled:!1,enumGranulaFilters:["prodType","sensorOpMode","sensorSwath","sarPolCh"],enumGranulaFilterLabels:{prodType:"Product type",sensorOpMode:"Sensor Mode",sensorSwath:"Sensor swath",sarPolCh:"Sensor polarisation"},continuousGranulaFilters:["cloudcp"],integerGranulaFilters:["relOrbit","path","row"],integerGranulaFilterLabels:{relOrbit:"Relative orbit",path:"Path",row:"Row"},reloadGranulaTimer:null,resultSet:"",gResultSet:"",queryablesForEntries:{},entries:{},drilledDownEntry:void 0,drilledDownItem:void 0,generateCurrentMapName:function(){var e="";return $(".dark_nolabels img").hasClass("active")&&(e="dark_nolabels"),$(".light_all img").hasClass("active")&&(e="light_all"),$(".light_nolabels img").hasClass("active")&&(e="light_nolabels"),$(".addsat img").hasClass("active")&&(e="addsat"),$(".addhyb img").hasClass("active")&&(e="addhyb"),$(".removesat img").hasClass("active")&&(e="removesat"),$(".oceanBasemap img").hasClass("active")&&(e="oceanBasemap"),$(".topographicBasemap img").hasClass("active")&&(e="topographicBasemap"),$(".dark_all img").hasClass("active")&&(e="dark_all"),$(".WorldStreetBasemap img").hasClass("active")&&(e="WorldStreetBasemap"),e},generateSearchFormAttributes:function(){var e="";e=$("#searchChosen").length?$("#searchChosen").val():$(".search-input #searchForm input").val();var t=!1;$(".row-form-search .checkbox-decoration input").prop("checked")&&(t=!0);for(var a={},i={},r=0;r<MyWorkspace.Search.customFields.length;r++)if(MyWorkspace.isCustomFieldSelect(r)&&MyWorkspace.getCustomFieldValue(r)){a[MyWorkspace.getCustomFieldParamName(r)]=MyWorkspace.getCustomFieldValue(r);var s=$(".row-form-search ."+MyWorkspace.getCustomFieldFieldName(r)+" .multiselect-container li.active label");i[MyWorkspace.getCustomFieldParamName(r)]="",s.each(function(e,t){i[MyWorkspace.getCustomFieldParamName(r)]+=$(t).attr("title"),e<s.length-1&&(i[MyWorkspace.getCustomFieldParamName(r)]+=", ")})}var l=$(".row-form-search .search-option-select .active input").attr("value"),o="",n="",c="",d="",u="";"ChooseSelectorOptions"!=l&&currentCoordinates?(o=$(".row-form-search .search-option-select .active label").attr("title"),"Coordinates"==l?n=coordinatesForSearch(currentCoordinates):"Geolocation"==l?(c=$(".row-form-search #geolocation_search").val(),n=coordinatesForSearch(currentCoordinates)):"ContinentAndCountry"==l?(d=$(".row-form-search .country-select .active label").attr("title"),n=coordinatesForSearch(currentCoordinates)):"What3Words"==l&&(u=$(".row-form-search #w3w_search").val())):l="";var p=$("input[name='bbox_rel']:checked").attr("id"),m=$("input[name='bbox_rel']:checked").next("label").html(),g="",f="",h="",v=$("input[name='date']:checked").attr("id");v?h=$("input[name='date']:checked").next("label").html():(v="",g=$(".row-form-search .date #date-from").val(),f=$(".row-form-search .date #date-to").val());var b=0,x=0;"block"==$(".box_cloudcp").css("display")&&(b=$("#cloudcp-slider-range").slider("values",0),x=$("#cloudcp-slider-range").slider("values",1));var w="",k="";$(".results-icons:visible button.drill-up:visible").length&&(w=$(".results-icons:visible button.drill-up:visible").siblings("button.info").val(),k=$(".results-icons:visible button.drill-up:visible").closest(".result-text").find(".result-title").html());var y=e;y||(y="empty search words");var D={},S={},B="";if($(".filters").hasClass("active")){B="faceted-filters";var _="";_=$(".filters .tags-select .multiselect-container .active input").val();var A="";A=$(".filters .tags-select .multiselect-container .active label").attr("title");var C="";C=$(".filters .format-select .multiselect-container .active input").val();var M="";M=$(".filters .format-select .multiselect-container .active label").attr("title");var T="";T=$(".filters .source-select .multiselect-container .active input").val();var O="";O=$(".filters .source-select .multiselect-container .active label").attr("title");var R="";R=$(".filters .protocol-select .multiselect-container .active input").val();var F="";F=$(".filters .protocol-select .multiselect-container .active label").attr("title");var P="";P=$(".filters .organisation-select .multiselect-container .active input").val();var W="";W=$(".filters .organisation-select .multiselect-container .active label").attr("title"),_&&(D.keyword=_),A&&(S.keyword=A),C&&(D.format=C),M&&(S.format=M),T&&(D.source=T),O&&(S.source=O),R&&(D.protocol=R),F&&(S.protocol=F),P&&(D.organisation=P),W&&(S.organisation=W)}else if($(".granula-filters").hasClass("active")){B="granula-filters";var I="";I=$(".granula-filters .prodType-select .multiselect-container .active input").val();var L="";L=$(".granula-filters .prodType-select .multiselect-container .active label").attr("title");var q="";q=$(".granula-filters .sarPolCh-select .multiselect-container .active input").val();var V="";V=$(".granula-filters .sarPolCh-select .multiselect-container .active label").attr("title");var E="";E=$(".granula-filters .sensorOpMode-select .multiselect-container .active input").val();var G="";G=$(".granula-filters .sensorOpMode-select .multiselect-container .active label").attr("title");var N="";N=$(".granula-filters .sensorSwath-select .multiselect-container .active input").val();var U="";U=$(".granula-filters .sensorSwath-select .multiselect-container .active label").attr("title");var z="";z=$(".granula-filters .relOrbit-select input").val();var j="";j=$(".granula-filters .relOrbit-select input").val();var Q="";Q=$(".granula-filters .row-select input").val();var K="";K=$(".granula-filters .row-select input").val();var Y="";Y=$(".granula-filters .path-select input").val();var X="";X=$(".granula-filters .path-select input").val();var H="",J="";$(".granula-filters .box_cloudcp").is(":hidden")?H="":(H="["+b+","+x+"]",J="Cloud coverage: "+b+"-"+x+"%");var Z="";Z=$(".granula-filters .box-size.date input#date-from-granula").val();var ee="";ee=$(".granula-filters .box-size.date input#date-from-granula").val();var te="";te=$(".granula-filters .box-size.date input#date-to-granula").val();var ae="";ae=$(".granula-filters .box-size.date input#date-to-granula").val(),I&&(D.prodType=I),L&&(S.prodType=L),q&&(D.sarPolCh=q),V&&(S.sarPolCh=V),E&&(D.sensorOpMode=E),G&&(S.sensorOpMode=G),N&&(D.sensorSwath=N),U&&(S.sensorSwath=U),z&&(D.relOrbit=z),j&&(S.relOrbit=j),Q&&(D.row=Q),K&&(S.row=K),Y&&(D.path=Y),X&&(S.path=X),H&&(D.cloudcp=H),J&&(S.cloudcp=J),Z&&(D.dateFromGranula=Z),ee&&(S.dateFromGranula=ee),te&&(D.dateToGranula=te),ae&&(S.dateToGranula=ae)}else if($(".iris-filters").hasClass("active")){B="iris-filters";var ie="";ie=$(".iris-filters .magt-select .multiselect-container .active input").val();var re="";re=$(".iris-filters .magt-select .multiselect-container .active label").text().trim();var se="";se=$(".iris-filters .evtord-select .multiselect-container .active input").val();var le="";le=$(".iris-filters .evtord-select .multiselect-container .active label").text().trim();var oe="",ne="",ce="",de="",ue="",pe="",me="",ge="",fe="";fe=$(".iris-filters .box-size.date input#date-from-iris").val();var he="";he=$(".iris-filters .box-size.date input#date-from-iris").val();var ve="";ve=$(".iris-filters .box-size.date input#date-to-iris").val();var be="";be=$(".iris-filters .box-size.date input#date-to-iris").val(),oe=$("#mag-slider-range").slider("values",0).toString(),ce=$("#mag-slider-range").slider("values",1).toString(),ue=$("#depth-slider-range").slider("values",0).toString(),me=$("#depth-slider-range").slider("values",1).toString(),ne=$("#mag-slider-range").slider("values",0).toString(),de=$("#mag-slider-range").slider("values",1).toString(),pe=$("#depth-slider-range").slider("values",0).toString(),ge=$("#depth-slider-range").slider("values",1).toString(),ie&&(D.magt=ie),re&&(S.magt=re),se&&(D.evtOrd=se),le&&(S.evtOrd=le),oe&&(D.minMag=oe),ne&&(S.minMag=ne),ce&&(D.maxMag=ce),de&&(S.maxMag=de),ue&&(D.minDep=ue),pe&&(S.minDep=pe),me&&(D.maxDep=me),ge&&(S.maxDep=ge),fe&&(D.dateFromIris=fe),he&&(S.dateFromIris=he),ve&&(D.dateToIris=ve),be&&(S.dateToIris=be)}var xe=DAB.View.generateCurrentMapName();return{name:y,popularSearchId:MyWorkspace.Search.popularSearchId,query:e,fullAndOpenDataset:{value:t,label:"Full and Open Dataset"},dateFrom:g,dateTo:f,datePeriod:{value:v,label:h},aoiOption:{value:l,label:o},aoiBoundingBox:n,aoiGeolocation:c,aoiContinentAndCountry:d,aoiW3W:u,aoiRelation:{value:p,label:m},cloudCoverageFrom:{value:b,label:b+"%"},cloudCoverageTo:{value:x,label:x+"%"},queryParams:{value:a,label:i},folder:{value:w,label:k},filterParams:{value:D,label:S},filterSet:B,currMap:xe}},restoreSavedFilters:function(){if(Object.keys(MyWorkspace.Search.filterParams).length>0){var e=Object.keys(MyWorkspace.Search.filterParams);if("iris-filters"==MyWorkspace.Search.filterSet)e.indexOf("magt")>=0&&($(".iris-filters .magt-select select").multiselect("select",MyWorkspace.Search.filterParams.magt),$(".iris-filters .magt-select select").multiselect("refresh")),e.indexOf("evtOrd")>=0&&($(".iris-filters .evtord-select select").multiselect("select",MyWorkspace.Search.filterParams.evtOrd),$(".iris-filters .evtord-select select").multiselect("refresh")),e.indexOf("minMag")>=0&&e.indexOf("maxMag")>=0&&($("#mag-slider-range").slider("values",0,MyWorkspace.Search.filterParams.minMag),$("#mag-slider-range").slider("values",1,MyWorkspace.Search.filterParams.maxMag),$("div.box-mag > span").text("Magnitude limit: "+MyWorkspace.Search.filterParams.minMag+"-"+MyWorkspace.Search.filterParams.maxMag),$("#mag-slider-range").attr("data-value",MyWorkspace.Search.filterParams.minMag+"-"+MyWorkspace.Search.filterParams.maxMag)),e.indexOf("minDep")>=0&&e.indexOf("maxDep")>=0&&($("#depth-slider-range").slider("values",0,MyWorkspace.Search.filterParams.minDep),$("#depth-slider-range").slider("values",1,MyWorkspace.Search.filterParams.maxDep),$("div.box-depth > span").text("Depth: "+MyWorkspace.Search.filterParams.minDep+"-"+MyWorkspace.Search.filterParams.maxDep+" KM"),$("#depth-slider-range").attr("data-value",MyWorkspace.Search.filterParams.minDep+"-"+MyWorkspace.Search.filterParams.maxDep)),e.indexOf("dateFromIris")>=0&&($("#date-from-iris").val(MyWorkspace.Search.filterParams.dateFromIris),irisDateFrom=MyWorkspace.Search.filterParams.dateFromIris),e.indexOf("dateToIris")>=0&&($("#date-to-iris").val(MyWorkspace.Search.filterParams.dateToIris),irisDateTo=MyWorkspace.Search.filterParams.dateToIris);else if("faceted-filters"==MyWorkspace.Search.filterSet)e.indexOf("keyword")>=0&&($(".filters .tags-select select").multiselect("select",MyWorkspace.Search.filterParams.keyword),$(".filters .tags-select select").multiselect("refresh")),e.indexOf("format")>=0&&($(".filters .format-select select").multiselect("select",MyWorkspace.Search.filterParams.format),$(".filters .format-select select").multiselect("refresh")),e.indexOf("source")>=0&&($(".filters .source-select select").multiselect("select",MyWorkspace.Search.filterParams.source),$(".filters .source-select select").multiselect("refresh")),e.indexOf("protocol")>=0&&($(".filters .protocol-select select").multiselect("select",MyWorkspace.Search.filterParams.protocol),$(".filters .protocol-select select").multiselect("refresh")),e.indexOf("organisation")>=0&&($(".filters .organisation-select select").multiselect("select",MyWorkspace.Search.filterParams.organisation),$(".filters .organisation-select select").multiselect("refresh"));else if("granula-filters"==MyWorkspace.Search.filterSet){if(e.indexOf("prodType")>=0&&($(".granula-filters .prodType-select select").multiselect("select",MyWorkspace.Search.filterParams.prodType),$(".granula-filters .prodType-select select").multiselect("refresh")),e.indexOf("sarPolCh")>=0&&($(".granula-filters .sarPolCh-select select").multiselect("select",MyWorkspace.Search.filterParams.sarPolCh),$(".granula-filters .sarPolCh-select select").multiselect("refresh")),e.indexOf("sensorOpMode")>=0&&($(".granula-filters .sensorOpMode-select select").multiselect("select",MyWorkspace.Search.filterParams.sensorOpMode),$(".granula-filters .sensorOpMode-select select").multiselect("refresh")),e.indexOf("sensorSwath")>=0&&($(".granula-filters .sensorSwath-select select").multiselect("select",MyWorkspace.Search.filterParams.sensorSwath),$(".granula-filters .sensorSwath-select select").multiselect("refresh")),e.indexOf("relOrbit")>=0&&$(".granula-filters .relOrbit-select input").val(MyWorkspace.Search.filterParams.relOrbit),e.indexOf("row")>=0&&$("#filter-row").val(MyWorkspace.Search.filterParams.row),e.indexOf("path")>=0&&$("#filter-path").val(MyWorkspace.Search.filterParams.path),e.indexOf("cloudcp")>=0){var t=MyWorkspace.Search.filterParams.cloudcp;t=t.replace("]","").replace("[","").split(","),$("#cloudcp-slider-range").slider("values",0,t[0]),$("#cloudcp-slider-range").slider("values",1,t[1]),$("#cloudcp-slider-range").attr("data-value",t[0]+"-"+t[1]),$("div.box_cloudcp > label").text("Cloud coverage: "+t[0]+"-"+t[1]+"%")}e.indexOf("dateFromGranula")>=0&&($("#date-from-granula").val(MyWorkspace.Search.filterParams.dateFromGranula),granuleDateFrom=MyWorkspace.Search.filterParams.dateFromGranula),e.indexOf("dateToGranula")>=0&&($("#date-to-granula").val(MyWorkspace.Search.filterParams.dateToGranula),granuleDateTo=MyWorkspace.Search.filterParams.dateToGranula)}MyWorkspace.Search.filterParams=[],MyWorkspace.Search.filterSet=""}},getImagesLocation:function(){return GWP?$("#header_center").attr("src").split("images/")[0]:""},getBoundingBoxes:function(e){var t=[];return e.find("box").each(function(){var e=$(this).text();e.trim()&&(box=parseCoordinates(e),t.push(box))}),t=removeDuplicateBoxes(t)},getIrisCircles:function(e){var t,a="IRIS Incorporated Research Institutions for Seismology";if(e.find("contributor orgName").text()==a){var i=e.find("box").text(),r=.5*(Number(e.find("verticalextent minimum").text())+Number(e.find("verticalextent maximum").text())),s=e.find("title").text().indexOf("earthquake of magnitude ")+24,l=e.find("title").text().slice(s,s+3);return i.trim()&&l&&((t=new Object).coordinates=parseCoordinates(i),t.magnitude=l,t.depth=r),t}if(e.find("gmd\\:organisationName gco\\:CharacterString").text()==a){var i=e.find("gmd\\:southBoundLatitude gco\\:Decimal").text()+" "+e.find("gmd\\:westBoundLongitude gco\\:Decimal").text()+" "+e.find("gmd\\:northBoundLatitude gco\\:Decimal").text()+" "+e.find("gmd\\:eastBoundLongitude gco\\:Decimal").text(),r=.5*(Number(e.find("gmd\\:minimumValue gco\\:Real").text())+Number(e.find("gmd\\:maximumValue gco\\:Real").text())),s=e.find("gmd\\:title gco\\:CharacterString").text().indexOf("earthquake of magnitude ")+24,l=e.find("gmd\\:title gco\\:CharacterString").text().slice(s,s+3);return i.trim()&&l&&((t=new Object).coordinates=parseCoordinates(i),t.magnitude=l,t.depth=r),t}},presentMainResults:function(e,t,a){DAB.View.queryablesForEntries={},DAB.View.entries={},DAB.View.drillDownSearch=!1,DAB.View.granulaFiltersEnabled=!1,AOIAction=void 0;var i=!1;$(e.responseText).find("entry").each(function(){if("errmsgid"!=$(this).find("id").text())return i=!0,!1}),200==e.status?i?(DAB.View.presentResults($(e.responseText),Geoss.resultsContainer),LogStore.getRecentActionsLog($(e.responseText)),t($(e.responseText))):a("noresults"):a("xhr")},presentDrillDownResults:function(e,t,a){GWP&&$(".have_to_be").trigger("click");var i=$(e.responseText).find("entry");200==e.status?0==i.length||"errmsgid"==i.first().find("id").text()&&i.first().find("title").text().indexOf(0==SATELITE_SEARCH_EMPTY_MSG)?a("noresults"):(DAB.View.presentResults($(e.responseText),Geoss.resultsContainer+" .drill-box"),t($(e.responseText))):a("xhr")},presentResults:function(e,t){gResultSet=e,$(t).children().remove();var a=e.find("totalResults").text();DAB.Client.reqID=null;var i=0;GWP&&(DAB.View.drillDownSearch?$(".black.drilldown").remove():$(".black.main").remove()),e.find("entry").each(function(e,a){var r=$(Geoss.resultsContainer+" .list-result").length,s=$(this).find("id").text();if("errmsgid"!=s&&($(t).append(DAB.View.listResult($(this),e)).children(":last-child").attr("data-id",r),$(t).children(":last-child").data("target-id",s),$(t).children(":last-child").data("entry-xml",$(this)[0].outerHTML),$(t).children(":last-child").find(".result-title").dotdotdot({watch:window,height:46,ellipsis:" ... "}),$(this).find("satelliteCollectionQueryable").each(function(){DAB.View.queryablesForEntries[s]=$(this).text()}),""!=$(this).find("acquisition platformid").text()&&(DAB.View.entries[s]=$(this))),GWP)try{var l=DAB.View.getBoundingBoxes($(this)),o=$(this).find("acquisition footprint").first().text(),n=DAB.View.getIrisCircles($(this));if((l[0]||o||n)&&!stopQueryTriggered){var c={boxes:l,footprints:o,irisCircles:n};boundingBoxes_1(c,r)}}catch(e){console.error("Error drawing bounding box for result number: "+r),console.error("Error:"+e)}i++}),$(t).append('<div class="drill-box"></div>'),GWP&&(i>0&&(searches(),DAB.View.updateFacetedCriteria(e),DAB.View.reloadSliders()),!DAB.View.drillDownSearch&&a>0&&(MyWorkspace.isRestoredGranulaSearch()?MyWorkspace.restoreGranulaSearch():MyWorkspace.isRestoredDrillDownBookmark()&&MyWorkspace.restoreDrillDownBookmark()))},updateAndShowGranulaFilters:function(e){var t=!1;DAB.View.enumGranulaFilters.forEach(function(a){DAB.View.updateAndShowOneGranulaFilter(e,a,DAB.View.enumGranulaFilterLabels[a])&&(t=!0)});var a=DAB.View.queryablesForEntries[DAB.View.drilledDownEntry];return DAB.View.continuousGranulaFilters.forEach(function(e){null!=a&&void 0!=a&&a.indexOf(e)>=0?($(".box_"+e).show(),t=!0):$(".box_"+e).hide()}),DAB.View.integerGranulaFilters.forEach(function(e){DAB.View.updateAndShowOneIntegerGranulaFilter(DAB.View.integerGranulaFilterLabels[e],e,a)}),t},updateAndShowOneIntegerGranulaFilter:function(e,t,a){return null!=a&&void 0!=a&&a.indexOf(t)>=0?($("."+t+"-select").show(),$("."+t+"-select input").show(),$("."+t+"-select input").keypress(function(e){13==e.which&&DAB.View.reloadGranulaData()}),$("."+t+'-select input[type="number"]').on("input",function(e){var t=$(this)[0].validity;!0!==t.valueMissing&&!0!==t.typeMismatch&&!0!==t.patternMismatch&&!0!==t.tooLong&&!0!==t.tooShort&&!0!==t.rangeUnderflow&&!0!==t.rangeOverflow&&!0!==t.stepMismatch&&!0!==t.badInput&&!0!==t.customError||$(this).val("");var a=$(this).val();a&&!/^\d+$/.test(a)&&($(this).val(""),a="");var i=$(this).data("previous-value");i||(i=""),(a!=i||DAB.View.reloadGranulaTimer)&&(DAB.View.reloadGranulaTimer&&clearTimeout(DAB.View.reloadGranulaTimer),DAB.View.reloadGranulaTimer=setTimeout(function(){DAB.View.reloadGranulaTimer=null,DAB.View.reloadGranulaData()},1500),$(this).data("previous-value",a))}),!0):($("."+t+"-select").hide(),!1)},updateAndShowOneGranulaFilter:function(e,t,a){var i=!1;$("."+t+"-select").children(":first-child").remove(),$("."+t+"-select").append('<select class="single-select '+t+'" title="'+a+'"></select>'),$("."+t+"-select ."+t).append('<option value="">'+a+"</option>"),e.find("dm\\:termFrequency dm\\:"+t+" dm\\:item").each(function(e){$("."+t+"-select ."+t).append('<option title="'+$(this).find("dm\\:decodedTerm").text()+'" value="'+$(this).find("dm\\:term").text()+'">'+$(this).find("dm\\:decodedTerm").text()+" ("+$(this).find("dm\\:freq").text()+")</option>"),i=!0});var r=$(".granula-filters ."+t+"-select .active input").parent().attr("title");$(".granula-filters ."+t+"-select .active input").text();return void 0!=r&&r!=a?$("."+t+"-select .multiselect").attr("title",r):$("."+t+"-select .multiselect").attr("title",a),i&&DAB.View.reloadGranulaFilters(t),i?(console.log("show"),$(".granula-filters ."+t+"-select").show(),DAB.View.reloadProductTypeMuselect(t)):$(".granula-filters ."+t+"-select").hide(),$("."+t+"-select .btn-group:first-child").remove(),i},reloadProductTypeMuselect:function(e){$("."+e+"-select .btn-group:first-child .multiselect-container li").each(function(t,a){if($(a).hasClass("active"))var i=$(a).find("input").val();$("."+e+"-select .btn-group:last-child .multiselect-container li").each(function(t,a){var r=$(a).find("input").val(),s=$(a).find("label").text();i==r?($(a).addClass("active"),$(a).find("input").prop("checked",!0),$("."+e+"-select .btn-group:last-child .multiselect-selected-text").text(s)):($("."+e+"-select .btn-group:last-child .multiselect-container li:first-child").removeClass("active"),$("."+e+"-select .btn-group:last-child .multiselect-container li:first-child input").prop("checked",!1))})})},updateFacetedSelectedElement:function(e){".tags-select"==e&&(queryName="keyword"),".format-select"==e&&(queryName="format"),".source-select"==e&&(queryName="source"),".protocol-select"==e&&(queryName="protocol"),".organisation-select"==e&&(queryName="organisationName");var t=$(e+" .single-select option").length-1;DAB.View.numberOfOptions+=t,0==t?"new"==$(".filters").data("searchType")?$(e).css("display","none"):($(e+" .btn-group:last-child .multiselect").addClass("disabled"),$(e+" .btn-group:last-child .multiselect").css("background-color","#aaa"),$(e+" .btn-group:last-child .multiselect b").removeClass("caret")):($(e).css("display","inline"),$(e+" .btn-group:last-child .multiselect").removeClass("disabled"),$(e+" .btn-group:last-child .multiselect").css("background-color",""),$(e+" .btn-group:last-child .multiselect b").addClass("caret"),$(e+" .btn-group:first-child .multiselect-container li").each(function(t,a){if($(a).hasClass("active"))var i=$(a).find("input").val();$(e+" .btn-group:last-child .multiselect-container li").each(function(t,a){var r=$(a).find("input").val(),s=$(a).find("label").text();i==r?($(a).addClass("active"),$(a).find("input").prop("checked",!0),$(e+" .btn-group:last-child .multiselect-selected-text").text(s)):($(e+" .btn-group:last-child .multiselect-container li:first-child").removeClass("active"),$(e+" .btn-group:last-child .multiselect-container li:first-child input").prop("checked",!1))})})),$(e+" .btn-group:first-child").remove()},updateFacetedCriteria:function(e){$(".tags-select").children(":first-child").remove(),$(".tags-select").append('<select class="single-select tags" title="KEYWORDS"></select>'),$(".tags-select .tags").append('<option value="">KEYWORD</option>'),e.find("dm\\:termFrequency dm\\:keyword dm\\:item").each(function(e){$(".tags-select .tags").append('<option title="'+$(this).find("dm\\:decodedTerm").text()+'" value="'+$(this).find("dm\\:term").text()+'">'+$(this).find("dm\\:decodedTerm").text()+" ("+$(this).find("dm\\:freq").text()+")</option>")}),$(".format-select").children(":first-child").remove(),$(".format-select").append('<select class="single-select formats" title="FORMAT"></select>'),$(".format-select .formats").append('<option value="">FORMAT</option>'),e.find("dm\\:termFrequency dm\\:format dm\\:item").each(function(e){$(".format-select .formats").append('<option title="'+$(this).find("dm\\:decodedTerm").text()+'" value="'+$(this).find("dm\\:term").text()+'">'+$(this).find("dm\\:decodedTerm").text()+" ("+$(this).find("dm\\:freq").text()+")</option>")}),$(".source-select").children(":first-child").remove(),$(".source-select").append('<select class="single-select source" title="SOURCE"></select>'),$(".source-select .source").append('<option value="">SOURCE</option>'),e.find("dm\\:termFrequency dm\\:source dm\\:item").each(function(e){$(".source-select .source").append('<option title="'+$(this).find("dm\\:term").text()+'" value="'+$(this).find("dm\\:sourceId").text()+'">'+$(this).find("dm\\:term").text()+" ("+$(this).find("dm\\:freq").text()+")</option>")}),$(".protocol-select").children(":first-child").remove(),$(".protocol-select").append('<select class="single-select protocol" title="PROTOCOL"></select>'),$(".protocol-select .protocol").append('<option value="">PROTOCOL</option>'),e.find("dm\\:termFrequency dm\\:protocol dm\\:item").each(function(e){$(".protocol-select .protocol").append('<option title="'+$(this).find("dm\\:decodedTerm").text()+'" value="'+$(this).find("dm\\:term").text()+'">'+$(this).find("dm\\:decodedTerm").text()+" ("+$(this).find("dm\\:freq").text()+")</option>")}),$(".organisation-select").children(":first-child").remove(),$(".organisation-select").append('<select class="single-select organisation" title="ORGANISATION"></select>'),$(".organisation-select .organisation").append('<option value="">ORGANISATION</option>'),e.find("dm\\:termFrequency dm\\:organisationName dm\\:item").each(function(e){var t=$(this).find("dm\\:decodedTerm").text(),a="";if(t.indexOf("u'name':")>-1){for(var i=t.split("u'name':").length-1,r=0;r<i;r++){var s=t.indexOf("u'name':")+11,l=t.substring(s),o=l.indexOf("}")-1;t=l,a=a+l.substring(0,o)+" "}t=a}else t=t;$(".organisation-select .organisation").append('<option title="'+t+'" value="'+$(this).find("dm\\:term").text()+'">'+t+" ("+$(this).find("dm\\:freq").text()+")</option>")}),$(document).ajaxComplete(function(){DAB.View.numberOfOptions=0,DAB.View.updateFacetedSelectedElement(".tags-select"),DAB.View.updateFacetedSelectedElement(".format-select"),DAB.View.updateFacetedSelectedElement(".source-select"),DAB.View.updateFacetedSelectedElement(".protocol-select"),DAB.View.updateFacetedSelectedElement(".organisation-select"),0==DAB.View.numberOfOptions?($(".filters > span").html("No filters available"),$(".filters #faceted-filters").css("display","none"),$(".filters").addClass("noavailable")):($(".filters > span").html("Filters"),$(".filters #faceted-filters").css("display","initial"),$(".filters").removeClass("noavailable"))}),DAB.View.reloadFilters(),$(".wrap-result-list .result-text .results-icons button.info").off("click"),$(".wrap-result-list .result-text .results-icons button.info").click(function(){LogStore.ga_category="discovery",LogStore.logSearchResult(searchFormAttributes,"search_query",$(this).id,$(this).attr("class"),$(this).val(),"dab","viewed");var e=DAB.View.entries[$(this).attr("value")];void 0!=e&&null!=e?DAB.View.presentSatelliteMetadata(e):DAB.Facade.getMetadata($(this).attr("value"))}),DAB.View.setFacetedTitles(),$(".box-layers-map .checkbox-decoration #hideBoundingBoxes").prop("checked")||$(".box-layers-map .checkbox-decoration .bbox").trigger("click"),hoverInteractiveMode=!0},presentSatelliteMetadata:function(e){if($(".black.black1").children().remove(),$(".black.black1").append(DAB.View.satelliteMetadataGenerator(e)),$(".black1").show(),GeossUtil.handleDragAndResize($(".black.black1 .resource-details-wrapper"),".resource-detais"),!$(".black.black1").hasClass("resize-handled")){$(".black.black1").addClass("resize-handled");var t=window.innerWidth;$(window).on("resize",function(){window.innerWidth!=t&&(GeossUtil.handleDragAndResize($(".black.black1 .resource-details-wrapper"),".resource-detais"),t=window.innerWidth)})}DAB.View.scroll_metadate&&($("#portlet_geosssearch_WAR_geossportlet > div > div > div > div.black.black1 > div").animate({scrollTop:$("#portlet_geosssearch_WAR_geossportlet > div > div > div > div.black.black1 > div > div.main-desc.downloads").offset().top},2e3),DAB.View.scroll_metadate=!1);var a={boxes:DAB.View.getBoundingBoxes(e),footprints:e.find("acquisition footprint").first().text(),irisCircles:DAB.View.getIrisCircles(e)};DAB.View.drawMetadataMap(a)},drawMetadataMap:function(e){var t=new ol.Map({target:"infoMap",layers:[new ol.layer.Tile({source:new ol.source.XYZ({tileSize:[512,512],url:"https://api.mapbox.com/styles/v1/mapbox/satellite-v9/tiles/{z}/{x}/{y}?access_token="+mapBoxAccessToken})})],view:new ol.View({center:ol.proj.fromLonLat([10,20]),zoom:1.5}),controls:[],interactions:[]}),a=drawFeature(e,0);a&&(t.addLayer(a),zoomOnFeatures(t,a)),$(".resource-detais .infoMap .ol-viewport.ol-touch").css({"touch-action":"auto","pointer-events":"none"})},setFacetedTitles:function(){var e=$(".filters .tags-select .active input").parent().attr("title");void 0!=e&&"keyword"!=e?$(".tags-select .multiselect").attr("title",e):$(".tags-select .multiselect").attr("title","KEYWORD");var t=$(".filters .format-select .active input").parent().attr("title");"format"!=t&&void 0!=t?$(".format-select .multiselect").attr("title",t):$(".format-select .multiselect").attr("title","FORMAT");var a=$(".filters .source-select .active input").parent().attr("title");"source"!=a&&void 0!=a?$(".source-select .multiselect").attr("title",a):$(".source-select .multiselect").attr("title","SOURCES");var i=$(".filters .protocol-select .active input").parent().attr("title");"protocol"!=i&&void 0!=i?$(".protocol-select .multiselect").attr("title",i):$(".protocol-select .multiselect").attr("title","PROTOCOL");var r=$(".filters .organisation-select .active input").parent().attr("title");"organisation"!=r&&void 0!=r?$(".organisation-select .multiselect").attr("title",r):$(".organisation-select .multiselect").attr("title","ORGANISATION")},drillDown:function(e,t){DAB.View.drilledDownEntry=e,DAB.View.drilledDownItem=t,DAB.View.drillDownSearch||(clicked=1,DAB.View.temp_startIndex=clicked),DAB.View.drillDownSearch=!0,$(t).next().show(),$(t).hide();$(".row-search .search-input input").val();$(".have_to_be").trigger("click"),DAB.Facade.drillDown(e),$(".drill-box").show(),$(".wrap-result-list .result-rows > .list-result").hide(),$('.wrap-result-list .result-rows > .list-result[data-id="'+$(t).closest(".list-result").attr("data-id")+'"]').show(),showQueryProgress()},drillDownPagination:function(){$(".pagination-container .inside-container").attr("data-number-prev-page",$(".pagination-container .inside-container").attr("data-number-page")),$(".pagination-container .inside-container").attr("data-number-page",1)},drillUp:function(e){var t=$(".pagination-container .inside-container").attr("data-number-prev-page");MyWorkspace.isRestoredGranulaSearch()?$(".search-button-2 span").trigger("click"):(MyWorkspace.isRestoredDrillDownBookmark()&&MyWorkspace.drillUpBookmarkedResult(),DAB.View.drillDownSearch=!1,DAB.View.granulaFiltersEnabled=!1,AOIAction=void 0,DAB.View.switchToMainResultsView(),DAB.View.temp_startIndex=t,clicked=DAB.View.temp_startIndex,DAB.View.temp_endIndex=parseInt(DAB.View.temp_startIndex)+9,$(".pagination-container .inside-container").attr("data-number-page",DAB.View.temp_startIndex),$(".pagination-container .numbers-pagination").text(DAB.View.temp_startIndex+"-"+DAB.View.temp_endIndex+" of "+DAB.View.temp_totalResults),DAB.View.temp_endIndex>=DAB.View.temp_totalResults?(DAB.View.temp_endIndex=DAB.View.temp_totalResults,$(".pagination-container .inside-container span.next").addClass("disabled")):$(".pagination-container .inside-container span.next").removeClass("disabled"),1==DAB.View.temp_startIndex?$(".pagination-container .inside-container span.prev").addClass("disabled"):$(".pagination-container .inside-container span.prev").removeClass("disabled"),$(".pagination-container").show(),$(e).prev().show(),$(e).hide(),DAB.View.closeAndClearGranulaFilters())},switchToMainResultsView:function(){$(".drill-box").hide(),$(".drill-box").empty(),$(".box_cloudcp").hide(),$(".box_relOrbit").hide(),$(".wrap-result-list .result-rows > .list-result").show(),$(".row-result-form .number-result .number-results").text(DAB.View.temp_totalResults)},closeAndClearGranulaFilters:function(){$("div.granula-filters").removeClass("active"),$("div.granula-filters").hide(),DAB.View.enumGranulaFilters.forEach(function(e){$("#granula-filters-set > ."+e+"-select").children().remove(),$("#granula-filters-set > ."+e+"-select").append('<select class="single-select '+e+'" title="'+DAB.View.enumGranulaFilterLabels[e]+'"></select>')}),DAB.View.reloadSliders(),DAB.View.continuousGranulaFilters.forEach(function(e){$(".box_"+e).hide()}),DAB.View.integerGranulaFilters.forEach(function(e){$("."+e+"-select").hide(),$("."+e+"-select input").val(""),$("."+e+"-select input").data("previous-value","")}),$(".granula-filters .date #date-from-granula").val(""),$(".granula-filters .date #date-to-granula").val(""),granuleDateFrom="",granuleDateTo=""},closeGranulaFilters:function(){$("div.granula-filters").removeClass("active"),$("div.granula-filters").hide(),$(".box_cloudcp").hide(),$(".box_relOrbit").hide(),DAB.View.integerGranulaFilters.forEach(function(e){$("."+e+"-select").hide()})},clearGranulaFilters:function(){DAB.View.enumGranulaFilters.forEach(function(e){$("#granula-filters-set > .prodType-select").children().remove(),$("#granula-filters-set > .prodType-select").append('<select class="single-select '+e+'" title="'+DAB.View.enumGranulaFilterLabels[e]+'"></select>')}),DAB.View.reloadSliders(),DAB.View.integerGranulaFilters.forEach(function(e){$("."+e+"-select input").val(""),$("."+e+"-select input").data("previous-value","")}),$(".row-form-search .date #date-from-granula").val(""),$(".row-form-search .date #date-to-granula").val(""),granuleDateFrom="",granuleDateTo=""},fixhtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerHTML},presentMetadata:function(e,t){if(200==e.status){var a=$(e.responseText);DAB.View.gdata=a;var i=[];$(a).find("gmd\\:EX_GeographicBoundingBox").each(function(){var e=$(this).find("gmd\\:westBoundLongitude gco\\:Decimal").text(),t=$(this).find("gmd\\:eastBoundLongitude gco\\:Decimal").text(),a=$(this).find("gmd\\:southBoundLatitude gco\\:Decimal").text(),r=$(this).find("gmd\\:northBoundLatitude gco\\:Decimal").text();e&&a&&t&&r&&i.push([Number(e),Number(a),Number(t),Number(r)])}),i=removeDuplicateBoxes(i);var r=DAB.View.getIrisCircles(a);if($(".black.black1").children().remove(),$(".black.black1").append(DAB.View.metadataGenerator(a,t,i)),$(".black1").show(),GeossUtil.handleDragAndResize($(".black.black1 .resource-details-wrapper"),".resource-detais"),!$(".black.black1").hasClass("resize-handled")){$(".black.black1").addClass("resize-handled");var s=window.innerWidth;$(window).on("resize",function(){window.innerWidth!=s&&(GeossUtil.handleDragAndResize($(".black.black1 .resource-details-wrapper"),".resource-detais"),s=window.innerWidth)})}DAB.View.scroll_metadate&&($("#portlet_geosssearch_WAR_geossportlet > div > div > div > div.black.black1 > div").animate({scrollTop:$("#portlet_geosssearch_WAR_geossportlet > div > div > div > div.black.black1 > div > div.main-desc.downloads").offset().top},2e3),DAB.View.scroll_metadate=!1);var l={boxes:i,footprints:null,irisCircles:r};DAB.View.drawMetadataMap(l)}else DAB.View.showMessage(TITLE_BACKEND_ERROR,MSG_BACKEND_ERROR)},listResult:function(e,t){return"<div class='list-result'>"+DAB.View.resultImages(e)+DAB.View.resultText(e,t)+"</div>"},resultText:function(e,t){var a=e.find("summary").text().replace(/(\r\n|\n|\r)/gm,"");try{a=$(a).text()}catch(e){}a=(a=a.replace(/\s+/g," ")).length>300?DAB.View.fixhtml(a.substr(0,300))+" ...":DAB.View.fixhtml(a);e.html();var i=$(e.find("contributor orgName")[0]).text();return void 0!=i&&""!=i||(i="unknown"),"<div class='result-text'>       <div class='wrap-list-text'>           <div class='result-title'>"+e.find("title").text()+"</div>           <div class='resultboxtext'>(Organization: <span>"+i+"</span>)</div>           <div class='result-description'>"+a+"</div>"+DAB.View.satelliteSpecyficData(e)+"       </div>"+DAB.View.resultDataTypes(e,t)+"   </div>"},roundSizeMB:function(e){return e>1e3?(parseInt(e)/1e3).toFixed(1)+"GB":e<1?parseInt(1e3*e)+"KB":parseInt(e).toFixed(0)+"MB"},extractDate:function(e){return e.indexOf("T")>=0?e.slice(0,e.indexOf("T")):e},satelliteSpecyficData:function(e){var t=!1;e.find('category[term="hlevel"]').each(function(){"series"==$(this).attr("label")&&(t=!0)}),t?(satelliteParamsForRBoxParams.dtstart[4]="Collection start date",satelliteParamsForRBoxParams.dtstop[4]="Collection stop date"):(satelliteParamsForRBoxParams.dtstart[4]="Start date",satelliteParamsForRBoxParams.dtstop[4]="Stop date");var a="<div class='resultboxtext'>";return satelliteParamsForRBox.forEach(function(t){var i=satelliteParamsForRBoxParams[t];if(i[1]){var r=e.find(t);if(void 0!=r&&null!=r&&r.text().length>0&&"Approx"!=r.text()){var s=i[0];null!=i[4]&&(s=i[4]);var l=r.text();null!=i[5]&&(l=i[5](l)),a+="<b>"+s+":</b> "+l+" "}}}),a+="</div>"},resultImages:function(e){var t=e.find("atom\\:logo").text();return"<div class='result-images'>   <div class='image'>      "+(null!=t&&t.length>0?"<img src='"+t+"' alt='Resource preview not available' class='big-image'>":"<img src='' alt='Resource preview not available' class='big-image'>")+"       </div><div><img src='"+DAB.View.getImagesLocation()+"images/img/dataCoreIcon.png' alt='data Core Icon' class='dataCoreIcon'>   </div>   <div class='recent-views'>      <span class='nr-views'>0 recent views</span>   </div></div>"},resultDataTypes:function(e,t){var a="";e.find('category[term="hlevel"]').each(function(){"series"==$(this).attr("label")&&GWP&&(a="       <button class='drill-down' title='Show inside folder' onclick='DAB.View.drillDownPagination();DAB.View.drillDown(\""+e.find("id").text()+"\",this)'></button>       <button class='drill-up' title='Hide inside folder' onclick='DAB.View.drillUp(this)'></button>")});var i,r,s,l,o,n,c,d,u,p,m,g,f,h="",v=[],b=[],x=[],w=[],k=[],y=[],D=[],S=[],B=[],_=[];if(e.find("gmd\\:online gmd\\:ci_onlineresource gmd\\:linkage gmd\\:url").each(function(t,a){var i=$(a).text(),r=$(a).closest("gmd\\:onLine").find("gmd\\:name gco\\:characterstring").text(),s=$(a).closest("gmd\\:onLine").find("gmd\\:function gmd\\:ci_onlinefunctioncode").text(),l=$(a).closest("entry").find("title").text(),o="",n=$(a).closest("gmd\\:onLine").find("gmd\\:protocol gco\\:characterstring").text(),c=$(e).find("title").text();void 0==(o=$(this).closest("gmd\\:ci_onlineresource").find("gmd\\:description").html())&&(o=""),0==r.length&&(r=0!=s.length?s:c);var d=$(a).closest("gmd\\:onLine").find("gmd\\:description gco\\:characterstring").text(),u=$(a).closest("gmd\\:onLine").find("gmd\\:name gco\\:characterstring").text();if(""==d&&""!=u&&(d=u),i.lastIndexOf(".pdf")>-1&&!(o.indexOf("complex")>0)&&""!=i)".pdf"==i.substr(i.length-4)&&v.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c});else if(i.lastIndexOf(".txt")>-1&&!(o.indexOf("complex")>0)&&""!=i)".txt"==i.substr(i.length-4)&&b.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c});else if(!(i.lastIndexOf(".html")>-1||i.lastIndexOf(".shtml")>-1)||o.indexOf("complex")>0||""==i)if(!(i.lastIndexOf(".jpg")>-1||i.lastIndexOf(".png")>-1)||-1!=i.indexOf("tile")||o.indexOf("complex")>0||""==i)if(i.lastIndexOf(".xml")>-1&&!(o.indexOf("complex")>0)&&""!=i)".xml"==i.substr(i.length-4)&&k.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c});else if(n.indexOf("WebMapService")>-1&&""!=i){var p=$(this).closest("entry").find("atom\\:logo").text(),m=i,g=l,f=$(this).closest("gmd\\:ci_onlineresource").find("gmd\\:name gco\\:characterstring").text(),h=$(this).closest("gmd\\:ci_onlineresource").find("gmd\\:protocol gco\\:characterstring").text(),A="1.0";if(h.indexOf("1.1.1")>0?A="1.1.1":h.indexOf("1.1.0")>0&&(A="1.1.0"),void 0!=o)if(o.indexOf("simple")>-1)C="simple";else if(o.indexOf("complex")>-1)var C="complex";void 0!=o&&o.indexOf("anchor")>-1&&(o.indexOf("simple")>-1||o.indexOf("complex")>-1)&&D.push({linkText:i,wmsImg:p,url:m,name:f,version:A,anchor:C,allName:g})}else if(n.indexOf("WebCoverageService")>-1)B.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c});else if(n.indexOf("TiledMapService")>-1&&!(o.indexOf("complex")>0)&&""!=i){var M=$(this).closest("gmd\\:ci_onlineresource").find("gmd\\:name gco\\:characterstring").text(),p=$(this).closest("entry").find("atom\\:logo").text();S.push({linkText:i,wmsImg:p,LAYERS:M})}else!(n.indexOf("WWW:LINK-1.0-http--link")>-1)||o.indexOf("complex")>0&&""!=i||i.indexOf("WMS")>-1||i.indexOf("wms")>-1||i.indexOf("WCS")>-1||i.indexOf("wcs")>-1||i.indexOf("TMS")>-1||i.indexOf("tms")>-1?""==i||i.indexOf("WMS")>-1||i.indexOf("wms")>-1||i.indexOf("WCS")>-1||i.indexOf("wcs")>-1||i.indexOf("TMS")>-1||i.indexOf("tms")>-1||o.indexOf("complex")>0||("/"==i.substr(i.length-1)&&""!=d?r.indexOf("GET DATA")>-1?_.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c}):r.indexOf("VIEW")>-1&&y.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c}):y.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c})):_.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c});else{var T=i.substr(i.length-4),O=i.substr(i.length-4);".jpg"!=T&&".png"!=O||""!=d&&w.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c})}else{var R=i.substr(i.length-5),F=i.substr(i.length-6);".html"!=R&&".shtml"!=F||(i.indexOf("opendap")>-1?_.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c}):x.push({linkText:i,linkTitle:r,linkDescription:d,titleBox:c}))}}),DAB.View.drillDownSearch)A="drilldown";else var A="main";if(v.length>1){var C="";i="<button class='pdf pdfBox' title='Download in pdf format' data-type='pdfBox_"+t+"'>pdf</button>";for(N=0;N<v.length;N++)C+="<li><span class=\"icon\">PDF</span><a href='javascript:void(0);' onclick='"+DAB.View.getDownloadAction(v[N].linkText)+"'>"+v[N].linkTitle+'</a><div class="description">'+v[N].linkDescription+"</div></li>";n='<div class="black black4 pdf pdf_'+t+" "+A+'" onclick="BlackBlack4Function(event)">\t<div class="popups resource-show">\t\t<div class="top-strip downld">'+v[0].titleBox+'<button class="close-popup glyphicon" title="close"></button></div>\t\t<ul class="results">'+C+"\t\t</ul>\t</div></div>"}else i=1==v.length?"<button class='pdf' title='Download in pdf format' onclick='"+DAB.View.getDownloadAction(v[0].linkText)+"'>pdf</button>":"";if(b.length>1){var M="";r="<button class='txt txtBox' title='Download in txt format' data-type='txtBox_"+t+"'>txt</button>";for(N=0;N<b.length;N++)M+="<li><span class=\"icon\">TXT</span><a href='javascript:void(0);' onclick='"+DAB.View.getDownloadAction(b[N].linkText)+"'>"+b[N].linkTitle+'</a><div class="description">'+b[N].linkDescription+"</div></li>";c='<div class="black black4 txt txt_'+t+" "+A+'" onclick="BlackBlack4Function(event)">\t<div class="popups resource-show">\t\t<div class="top-strip downld">'+b[0].titleBox+'<button class="close-popup glyphicon" title="close"></button></div>\t\t<ul class="results">'+M+"\t\t</ul>\t</div></div>"}else r=1==b.length?"<button class='txt' title='Download in txt format' onclick='"+DAB.View.getDownloadAction(b[0].linkText)+"'>txt</button>":"";if(x.length>1){var T="";s="<button class='html htmlBox' title='Download in html format' data-type='htmlBox_"+t+"'>html</button>";for(N=0;N<x.length;N++)T+="<li><span class=\"icon\">HTML</span><a href='javascript:void(0);' onclick='"+DAB.View.getDownloadAction(x[N].linkText)+"'>"+x[N].linkTitle+'</a><div class="description">'+x[N].linkDescription+"</div></li>";d='<div class="black html black4 html_'+t+" "+A+'" onclick="BlackBlack4Function(event)">\t<div class="popups resource-show">\t\t<div class="top-strip downld">'+x[0].titleBox+'<button class="close-popup glyphicon" title="close"></button></div>\t\t<ul class="results">'+T+"\t\t</ul>\t</div></div>"}else s=1==x.length?"<button class='html' title='Download in html format' onclick='"+DAB.View.getDownloadAction(x[0].linkText)+"'>html</button>":"";if(w.length>1){var O="";l="<button class='img imgBox' title='Download in img format' data-type='imgBox_"+t+"'>img</button>";for(N=0;N<w.length;N++)O+="<li><span class=\"icon\">IMG</span><a href='javascript:void(0);' onclick='"+DAB.View.getDownloadAction(w[N].linkText)+"'>"+w[N].linkTitle+'</a><div class="description">'+w[N].linkDescription+"</div></li>";u='<div class="black black4 img img_'+t+" "+A+'" onclick="BlackBlack4Function(event)">\t<div class="popups resource-show">\t\t<div class="top-strip downld">'+w[0].titleBox+'<button class="close-popup glyphicon" title="close"></button></div>\t\t<ul class="results">'+O+"\t\t</ul>\t</div></div>"}else l=1==w.length?"<button class='img' title='Download in img format' onclick='"+DAB.View.getDownloadAction(w[0].linkText)+"'>img</button>":"";if(k.length>1){var R="";o="<button class='xml xmlBox' title='Download in xml format' data-type='xmlBox_"+t+"'>xml</button>";for(N=0;N<k.length;N++)R+="<li><span class=\"icon\">XML</span><a href='javascript:void(0);' onclick='"+DAB.View.getDownloadAction(k[N].linkText)+"'>"+k[N].linkTitle+'</a><div class="description">'+k[N].linkDescription+"</div></li>";p='<div class="black black4 xml xml_'+t+" "+A+'" onclick="BlackBlack4Function(event)">\t<div class="popups resource-show">\t\t<div class="top-strip downld">'+k[0].titleBox+'<button class="close-popup glyphicon" title="close"></button></div>\t\t<ul class="results">'+R+"\t\t</ul>\t</div></div>"}else o=1==k.length?"<button class='xml' title='Download in xml format' onclick='"+DAB.View.getDownloadAction(k[0].linkText)+"'>xml</button>":"";if(y.length>1){var F="";buttonOther="<button class='other otherBox' title='Download in other format' data-type='xmlBox_"+t+"'>other</button>";for(N=0;N<y.length;N++){if((""==y[N].linkTitle||"all"==y[N].linkTitle)&&y[N].linkText.indexOf("MapServer")>-1)P="<a href='javascript:void(0);' onclick='"+DAB.View.getDownloadAction(y[N].linkText)+"'>Map Server</a>";else var P="<a href='javascript:void(0);' onclick='"+DAB.View.getDownloadAction(y[N].linkText)+"'>"+y[N].linkTitle+"</a>";F+='<li><span class="icon">OTHER</span>'+P+'<div class="description">'+y[N].linkDescription+"</div></li>"}f='<div class="black black4 other other_'+t+" "+A+'" onclick="BlackBlack4Function(event)">\t<div class="popups resource-show">\t\t<div class="top-strip downld">'+y[0].titleBox+'<button class="close-popup glyphicon" title="close"></button></div>\t\t<ul class="results">'+F+"\t\t</ul>\t</div></div>"}else 1==y.length?buttonOther="<button class='other' title='Download in other format' onclick='"+DAB.View.getDownloadAction(y[0].linkText)+"'>other</button>":buttonOther="";if(B.length>1){var W="";buttonWCS="<button class='wcs wcsBox' title='Download in wcs format' data-type='wcsBox_"+t+"'>wcs</button>";for(N=0;N<B.length;N++)W+="<li><span class=\"icon\">WCS</span><a href='javascript:void(0);' onclick='"+DAB.View.getDownloadAction(B[N].linkText)+"'>"+B[N].linkTitle+'</a><div class="description">'+B[N].linkDescription+"</div></li>";m='<div class="black black4 wcs wcs_'+t+" "+A+'" onclick="BlackBlack4Function(event)">\t<div class="popups resource-show">\t\t<div class="top-strip downld">'+B[0].titleBox+'<button class="close-popup glyphicon" title="close"></button></div>\t\t<ul class="results">'+W+"\t\t</ul>\t</div></div>"}else 1==B.length?buttonWCS="<button class='wcs' title='Download in wcs format' onclick='"+DAB.View.getDownloadAction(B[0].linkText)+"'>WCS</button>":buttonWCS="";if(_.length>1){var I="";buttonHyperlink="<button class='link linkBox' title='Links' data-type='linkBox_"+t+"'></button>";for(N=0;N<_.length;N++)I+="<li><span class=\"icon hyperlink\"></span><a href='javascript:void(0);' onclick='"+DAB.View.getDownloadAction(_[N].linkText)+"'>"+_[N].linkTitle+'</a><div class="description">'+_[N].linkDescription+"</div></li>";g='<div class="black black4 link link_'+t+" "+A+'" onclick="BlackBlack4Function(event)">\t<div class="popups resource-show">\t\t<div class="top-strip link">'+_[0].titleBox+'<button class="close-popup glyphicon" title="close"></button></div>\t\t<ul class="results">'+I+"\t\t</ul>\t</div></div>"}else 1==_.length?buttonHyperlink="<button class='link' title='Download' onclick='"+DAB.View.getDownloadAction(_[0].linkText)+"'></button>":buttonHyperlink="";var L,q="";if(D.length>0)for(var V,E,G="",N=0;N<D.length;N++){if(D[N].linkText.indexOf("LAYERS=")>-1){var U=D[N].linkText.indexOf("LAYERS="),z=D[N].linkText.indexOf("&",U),j=E=D[N].linkText.slice(U+7,z),Q="";G=D[N].linkText}else{var j=D[N].allName,U=1;E=D[N].name,G=D[N].url+"&&&LAYERS="+E+"&VERSION="+D[N].version+"&ANCHOR="+D[N].anchor}V=U>-1?'<li><div class="col-sm-7">'+j+'</div><div class="col-sm-5"><div class="box-size checkbox-decoration full-width"><input id="Layers_dataset_'+t+(Q=DAB.View.drillDownSearch?N+"10":N)+'" type="checkbox" namelayer="'+j+'" data-value="'+G+'" class="addLayerWMS non-clicked"><label for="Layers_dataset_'+t+Q+'" class="box-size">Load on the map</label></div></div><div class="col-sm-12"><img class="layer" src="'+D[N].wmsImg+'"></div><hr class="clear"></li>':"",void 0==L?L=V:L+=V}else L="";if(S.length>0)for(var K="",Y=0;Y<S.length;Y++){var X=Y+100,Q="";Q=DAB.View.drillDownSearch?X+"10":X,K='<li><div class="col-sm-7">'+S[Y].LAYERS+'</div><div class="col-sm-5"><div class="box-size checkbox-decoration full-width"><input id="Layers_dataset_'+t+Q+'" type="checkbox" namelayer="'+S[Y].LAYERS+'" data-value="'+S[Y].linkText+'" class="addLayerTMS non-clicked"><label for="Layers_dataset_'+t+Q+'" class="box-size">Load on the map</label></div></div><div class="col-sm-12"><img class="layer" src="'+S[Y].wmsImg+'"></div><hr class="clear"></li>',void 0==q?q=K:q+=K}else q="";if(D.length>0||S.length>0?(h="<button class='map map_"+t+"' title='Layers'></button>",downloadBoxWMS='<div class="black black2 wms black_'+t+" "+A+'">\t<div class="popups resource-show">\t\t<div class="top-strip">Showing Resources that can be loaded on MAP viewer <button class="close-popup glyphicon" title="close"></button></div>\t\t<ul class="results">'+L+q+"\t\t</ul>\t</div></div>"):(h="<button class='map' title='Show dialog box with map' disabled></button>",downloadBoxWMS=""),GWP&&($("body").append(n),$("body").append(c),$("body").append(d),$("body").append(u),$("body").append(p),$("body").append(f),$("body").append(downloadBoxWMS),$("body").append(m),$("body").append(g)),""!=i||""!=o||""!=r||""!=l||""!=s||""!=buttonOther||""!=buttonWCS)H="<button class='download' title='Downloads' value='"+e.find("id").text()+"'></button>";else var H="<button class='download' title='Downloads' disabled value='"+e.find("id").text()+"'></button>";if(GWP){var J="",Z=DAB.View.getBoundingBoxes(e),ee=mergeBoxes(Z);if(ee){var te=ee[0],ae=ee[1],ie=ee[2];J=ae+" "+te+" "+ee[3]+" "+ie}var re=e.find("id").text(),se="add",le="Add as bookmark";for(N=MyWorkspace.BookmarkedResults.length;N>=0;N--)re==MyWorkspace.BookmarkedResults[N]&&(se="remove",le="Remove from bookmarks")}return"<div class='results-icons'><div class='red-icons'><button class='info' title='More information' value='"+e.find("id").text()+"'></button>       <button class='add_map' "+(J?"":"disabled ")+"title='Show on map' value='"+J+"' onclick='centerMapOnEntry(\""+J+'", "add_map", "'+e.find("id").text()+"\" )'></button>\t    <button class='more-links'></button>"+(GWP?"       <button class='bookmark-button "+se+"' "+(Liferay.ThemeDisplay.isSignedIn()?"":"disabled ")+"title='"+le+"' type='button'></button>":"")+a+"</div><div class='orange-icons'>\t<div class='wrap-orange-icons'>   \t<div>"+H+"       \t<div class='details-download'>           \t<div>"+i+o+r+s+l+buttonWCS+buttonOther+"\t\t\t\t</div>\t\t\t</div>\t\t</div>\t</div>"+h+buttonHyperlink+"\t\t<button class='share' title='Share'></button>       <button class='like' disabled title='Social media' onclick=\"LikeFunction()\"></button></div><hr class='clear' /></div><div class='orange-icons-black'/>"},addLayerToBoxLayers:function(e){var t=$(e).attr("data-value"),a=$(e).attr("id")+"X",i=$(e).closest(".black2.wms").attr("class"),r=i.indexOf("show_");r>-1&&(i=(i=i.substring(r+5,r.length)).replace("active","").trim());var s=$(".add_map.showWmsOnMap_"+i).closest(".result-text").find(".resultboxtext span").html(),l=$(".add_map.showWmsOnMap_"+i).siblings(".info").attr("value"),o=$(".add_map.showWmsOnMap_"+i).attr("value"),n=$(e).attr("namelayer");0==$('.box-layers-map input[data-value="'+t+'"]').length&&($(".box-layers-map").append('<div data-value="'+a+"_"+t+'"><div class="checkbox-decoration"><input type="checkbox" id="'+a+"_"+t+'" checked="checked" data-value="'+t+'" data_organisation="'+s+'" data_uuid="'+l+'" data_coords="'+o+'"><label for="'+a+"_"+t+'">'+n+'</label><div class="wrap-buttons"><span class="closex" title="remove layer"></span><span class="goToMap" title="show on map" data-nr="'+i+'"></span></div><div class="box-layer-opacity"><span>Layer opacity: 100%</span><div id="layer-opacity-slider"></div></div></div></div><hr class="clear" />'),$('.box-layers-map input[data-value="'+t+'"]').prop("checked",!1),$('.box-layers-map div[data-value="'+a+"_"+t+'"] #layer-opacity-slider').slider({value:100,slide:function(e,t){$(this).siblings("span").text("Layer opacity: "+t.value+"%");var a=$(this).parent().siblings("input:checkbox").attr("data-value");setLayerOpacity(a,t.value/100)}}))},metadataGenerator:function(e,t,a){var i="";$(DAB.View.gdata).find("gmd\\:MD_Keywords gmd\\:keyword gco\\:CharacterString").each(function(){i+=$(this).text()+"<br/>"});var r=DAB.View.generateResourceMetadatLinks($(DAB.View.gdata)),s="",l=mergeBoxes(a);l&&(s=coordinatesForPresentation(l));var o=$(e.find("gmd\\:graphicOverview gmd\\:MD_BrowseGraphic gmd\\:fileName gco\\:CharacterString")[0]).text();if(null!=o&&o.length>0)n='\t\t\t <div class="result-images">\t\t\t    <div class="image">\t\t\t\t\t<a target="_blank" href = "'+o+'">       \t\t\t\t<img src="'+o+'" alt="Resource preview not available" class="big-image">\t\t\t\t\t</a>\t\t\t\t</div>\t\t\t</div>';else var n="";return'<div class="resource-details-wrapper"><div class="top-strip"><span class="title">Resources details</span><a class="link" href="http://www.geoportal.org/geoportal/vrd?uuid='+t+'" target="_blank">Show Raw Metadata</a><button class="close-popup glyphicon" title="close"></button>            </div><div class="popups resource-detais">        <div class="main-desc">            <span class="rs-title">'+$(e).find("gmd\\:MD_DataIdentification gmd\\:citation gmd\\:CI_Citation gmd\\:title > gco\\:CharacterString").text()+"</span><br/>            <br/>"+n+$(e).find("gmd\\:abstract gco\\:CharacterString").text()+'            </div>                <div class="info">            <div class="col-sm-6">            <b>Contact information</b><br/><b>Contributor:</b>'+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:contact gmd\\:CI_ResponsibleParty gmd\\:individualName gco\\:CharacterString").text()+"<br/>        <b>Delivery point: </b> "+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:contact gmd\\:CI_ResponsibleParty gmd\\:contactInfo gmd\\:deliveryPoint gco\\:CharacterString").text()+"<br/>        <b>City: </b>"+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:contact gmd\\:CI_ResponsibleParty gmd\\:contactInfo gmd\\:city gco\\:CharacterString").text()+"<br/>        <b>Postal Code: </b>"+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:contact gmd\\:CI_ResponsibleParty gmd\\:contactInfo gmd\\:postalcode gco\\:CharacterString").text()+"<br/>        <b>Country:</b> "+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:contact gmd\\:CI_ResponsibleParty gmd\\:contactInfo gmd\\:country gco\\:CharacterString").text()+"<br/>        <b>E-mail address:</b> "+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:contact gmd\\:CI_ResponsibleParty gmd\\:contactInfo gmd\\:electronicMailAddress gco\\:CharacterString").text()+"<br/>        <b>Organization name:</b> "+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:contact gmd\\:CI_ResponsibleParty  gmd\\:organisationName gco\\:CharacterString").text()+"<br/>        <b>Role:</b> "+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:contact gmd\\:CI_ResponsibleParty > gmd\\:role gmd\\:CI_RoleCode").text()+'        </div>        <div class="col-sm-6">            <b>Data identification</b><br/>        <b>File identifier:</b> '+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:fileIdentifier gco\\:CharacterString").text()+"<br/>        <b>Parent identifier:</b> "+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:parentIdentifier gco\\:CharacterString").text()+"<br/>        <b>Hierarchy level:</b> "+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:hierarchyLevelName gco\\:CharacterString").text()+"<br/>        <b>Date stamp:</b> "+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:datestamp gco\\:Date").text()+"<br/>        <b>Date language:</b> "+$(DAB.View.gdata).find("gmi\\:MI_Metadata > gmd\\:language gco\\:CharacterString").text()+'<br/>        </div>        <hr class="clear"/>            </div>            <div class="main-desc">            <br/><br/><span class="rs-title">Descriptive keywords</span><br/>        <br/>'+i+'</div>        <div class="info2">            <div class="col-sm-6">            <b>Bounding Rectangle:</b> '+s+'        </div>        <div class="col-sm-6">            <b>Temporal Extent:</b>Start ('+$(DAB.View.gdata).find("gmd\\:EX_TemporalExtent gml\\:begin gml\\:timePosition").text()+")End ("+$(DAB.View.gdata).find("gmd\\:EX_TemporalExtent gml\\:end gml\\:timePosition").text()+')        </div>        <hr class="clear"/>            </div>            <div id="infoMap" class="infoMap" tabindex="0"></div><div class="main-desc downloads"><span class="rs-title">Online Resources</span><hr class="clear"/>'+r+'<hr class="clear"/>        </div><hr class="clear"/>           </div></div>'},satelliteMetadataGenerator:function(e){var t=DAB.View.generateResourceMetadatLinks(e),a="",i="",r=DAB.View.getBoundingBoxes(e),s="",l=mergeBoxes(r);l&&(s=coordinatesForPresentation(l)),satelliteParamsForRBox.forEach(function(t){satelliteParamsForRBoxParams[t],satelliteParamsForRBoxParams[t][2]&&satelliteParamsForRBoxParams[t][3]?a+="<b>"+satelliteParamsForRBoxParams[t][0]+": </b>"+e.find(t).text()+"<br/>":(value=e.find(t).text(),""!=value&&(i+="<b>"+satelliteParamsForRBoxParams[t][0]+": </b>"+value+"<br/>"))});var o=e.find("atom\\:logo").text();if(null!=o&&o.length>0)n='\t\t\t <div class="result-images satellite">\t\t\t    <div class="image">\t\t\t\t\t<a target="_blank" href = "'+o+'">       \t\t\t\t<img src="'+o+'" alt="Resource preview not available" class="big-image">\t\t\t\t\t</a>\t\t\t\t</div>\t\t\t</div>';else var n="";return'<div class="resource-details-wrapper"><div class="top-strip"><span class="title">Resources details</span> <button class="close-popup glyphicon" title="close"></button>            </div><div class="popups resource-detais">        <div class="main-desc">'+n+'\t\t <span class="rs-title">'+e.find("title").text()+'</span>        </div>        <div class="info">            <div class="col-sm-6">            <b>General info</b><br/>'+a+'        </div>        <div class="col-sm-6">            <b>Scene parameters</b><br/>'+i+'        </div>        <hr class="clear"/>            </div>            <div class="main-desc">            <span class="rs-title">Descriptive keywords</span><br/>        <br/></div>        <div class="info2">            <div class="col-sm-6">            <b>Bounding Rectangle:</b> '+s+'        </div>        <hr class="clear"/>            </div>            <div id="infoMap" class="infoMap" tabindex="0"></div><div class="main-desc downloads"><span class="rs-title">Online Resources</span><hr class="clear"/>'+t+'        </div><hr class="clear"/>           </div></div>'},generateResourceMetadatLinks:function(e){var t=[],a=[],i=[],r=[],s=[],l=[],o=[],n=[];DAB.View.extractResourceLinks(e,t,a,i,i,r,s,l,o,n);var c="";if(t.length>1){for(var d="",u=0;u<t.length;u++)d+='<li><a href="'+t[u].linkText+'" class="link">'+t[u].linkTitle+"</a><br/><span>"+t[u].linkDescription+"</span></li>";c+='<hr class="clear"/><span class="section"><img src="/images/img/popups/m-link.png" alt=""/>PDF</span><ul>'+d+"</ul>"}if(a.length>1){for(var d="",u=0;u<a.length;u++)d+='<li><a href="'+a[u].linkText+'" class="link">'+a[u].linkTitle+"</a><br/><span>"+a[u].linkDescription+"</span></li>";c+='<hr class="clear"/><span class="section"><img src="/images/img/popups/m-link.png" alt=""/>Text</span><ul>'+d+"</ul>"}if(i.length>1){for(var d="",u=0;u<i.length;u++)d+='<li><a href="'+i[u].linkText+'" class="link">'+i[u].linkTitle+"</a><br/><span>"+i[u].linkDescription+"</span></li>";c+='<hr class="clear"/><span class="section"><img src="/images/img/popups/m-link.png" alt=""/>Hyperlinks</span><ul>'+d+"</ul>"}if(r.length>1){for(var d="",u=0;u<r.length;u++)d+='<li><a href="'+r[u].linkText+'" class="link">'+r[u].linkTitle+"</a><br/><span>"+r[u].linkDescription+"</span></li>";c+='<hr class="clear"/><span class="section"><img src="/images/img/popups/m-link.png" alt=""/>Image</span><ul>'+d+"</ul>"}if(s.length>1){for(var d="",u=0;u<s.length;u++)d+='<li><a href="'+s[u].linkText+'" class="link">'+s[u].linkTitle+"</a><br/><span>"+s[u].linkDescription+"</span></li>";c+='<hr class="clear"/><span class="section"><img src="/images/img/popups/m-link.png" alt=""/>XML</span><ul>'+d+"</ul>"}if(l.length>0){for(var d="",u=0;u<l.length;u++)d+="<li><a href='javascript:void(0);' onclick='"+DAB.View.getDownloadAction(l[u].linkText)+"' class='link'>"+l[u].linkTitle+"</a><br/><span>"+l[u].linkDescription+"</span></li>";c+='<hr class="clear"/><span class="section"><img src="/images/img/popups/m-link.png" alt=""/>Other</span><ul>'+d+"</ul>"}if(o.length>1||n.length>1){d="";if(o.length>1)for(u=0;u<o.length;u++)d+='<li class="col-sm-12"><a href="'+o[u].linkText+'" class="link">'+o[u].linkTitle+'</a><br/><img class="layer" alt="Preview not available" src="'+o[u].linkText.replace("${z}","0").replace("${x}","0").replace("${y}","0")+'"></li>';if(n.length>1)for(u=0;u<n.length;u++)d+='<li class="col-sm-12"><a href="'+n[u].linkText+'" class="link">'+n[u].linkTitle+'</a><br/><img class="layer" alt="Preview not available" src="'+n[u].linkText.replace("${z}","0").replace("${x}","0").replace("${y}","0")+'"></li>';c+='<hr class="clear"/><span class="section"><img src="/images/img/popups/m-link.png" alt=""/>WMS/TMS</span><ul>'+d+"</ul>"}return c},extractResourceLinks:function(e,t,a,i,i,r,s,l,o,n){e.find("gmd\\:onLine gmd\\:CI_OnlineResource gmd\\:linkage gmd\\:URL").each(function(e,c){var d=$(c).text(),u=$(c).closest("gmd\\:onLine").find("gmd\\:name gco\\:characterstring").text(),p=$(c).closest("gmd\\:onLine").find("gmd\\:function gmd\\:ci_onlinefunctioncode").text(),m=$(c).find("title").text();0==u.length&&(u=0!=p.length?p:m);var g=$(c).closest("gmd\\:onLine").find("gmd\\:description gco\\:characterstring").text(),f=$(c).closest("gmd\\:onLine").find("gmd\\:name gco\\:characterstring").text(),h="",v=$(c).closest("entry").find("title").text(),b=$(c).closest("gmd\\:onLine").find("gmd\\:protocol gco\\:characterstring").text();if(void 0==(h=$(this).closest("gmd\\:ci_onlineresource").find("gmd\\:description").html())&&(h=""),""==g&&""!=f&&(g=f),d.lastIndexOf(".pdf")>-1&&!(h.indexOf("complex")>0)&&""!=d)".pdf"==d.substr(d.length-4)&&t.push({linkText:d,linkTitle:u,linkDescription:g,titleBox:m});else if(d.lastIndexOf(".txt")>-1&&!(h.indexOf("complex")>0)&&""!=d)".txt"==d.substr(d.length-4)&&a.push({linkText:d,linkTitle:u,linkDescription:g,titleBox:m});else if(!(d.lastIndexOf(".html")>-1||d.lastIndexOf(".shtml")>-1)||h.indexOf("complex")>0||""==d)if(!(d.lastIndexOf(".jpg")>-1||d.lastIndexOf(".png")>-1)||-1!=d.indexOf("tile")||h.indexOf("simple")>0||""==d){if(d.lastIndexOf(".xml")>-1&&!(h.indexOf("simple")>0)&&""!=d)".xml"==d.substr(d.length-4)&&s.push({linkText:d,linkTitle:u,linkDescription:g,titleBox:m});else if(b.indexOf("WebMapService")>-1&&""!=d){var x=$(this).closest("entry").find("atom\\:logo").text(),w=d,k=v,y=$(this).closest("gmd\\:ci_onlineresource").find("gmd\\:name gco\\:characterstring").text(),D=$(this).closest("gmd\\:ci_onlineresource").find("gmd\\:protocol gco\\:characterstring").text(),S="1.0";if(D.indexOf("1.1.1")>0?S="1.1.1":D.indexOf("1.1.0")>0&&(S="1.1.0"),void 0!=h)if(h.indexOf("simple")>-1)B="simple";else if(h.indexOf("complex")>-1)var B="complex";void 0!=h&&h.indexOf("anchor")>-1&&(h.indexOf("simple")>-1||h.indexOf("complex")>-1)&&o.push({linkText:d,wmsImg:x,url:w,name:y,version:S,anchor:B,allName:k})}else if(b.indexOf("TiledMapService")>-1&&!(h.indexOf("complex")>0)&&""!=d){var _=$(this).closest("gmd\\:ci_onlineresource").find("gmd\\:name gco\\:characterstring").text(),x=$(this).closest("entry").find("atom\\:logo").text();n.push({linkText:d,linkTitle:u,wmsImg:x,LAYERS:_})}else if(!(h.indexOf("complex")>0||d.indexOf("WMS")>-1||d.indexOf("wms")>-1||d.indexOf("WCS")>-1||d.indexOf("wcs")>-1||d.indexOf("TMS")>-1||d.indexOf("tms")>-1||b.indexOf("WWW:LINK-1.0-http--link")>-1||""==d)){d.substr(d.length-1);l.push({linkText:d,linkTitle:u,linkDescription:g,titleBox:m})}}else{var A=d.substr(d.length-4),C=d.substr(d.length-4);(".jpg"==A||".png"==C&&-1==d.indexOf("tile"))&&r.push({linkText:d,linkTitle:u,linkDescription:g,titleBox:m})}else{var M=d.substr(d.length-5),T=d.substr(d.length-6);".html"!=M&&".shtml"!=T||i.push({linkText:d,linkTitle:u,linkDescription:g,titleBox:m})}})},reloadFilters:function(){$(".row-result-form .show-result .filters .single-select").multiselect({onChange:function(e,t,a){""!=$(e).val()?$(e).closest(".filters").addClass("notEmpty"):$(e).closest(".filters").removeClass("notEmpty"),chooseFilteringIcon(),$(".have_to_be").trigger("click"),showQueryProgress();$(".row-search .search-input input").val();DAB.Facade.filterQuery(!0),DAB.View.setFacetedTitles()}})},reloadGranulaFilters:function(e){$("#granula-filters-set > ."+e+"-select > select").multiselect({onChange:function(e,t,a){$(".have_to_be").trigger("click"),showQueryProgress(),DAB.View.clearPagination();$(".row-search .search-input input").val();DAB.Facade.drillDown(DAB.View.drilledDownEntry)}})},clearResults:function(){$(".row-result-form .number-result .number-results").text(0),$(".pagination-container .numbers-pagination").text(),$(".wrap-result-list .result-rows").children().remove(),$(".result-wrap").scrollTop(1)},closeResults:function(){$(".row-result-form .number-result .number-results").text(0),$(".pagination-container .numbers-pagination").text(),$(".result-wrap").scrollTop(1)},getDownloadAction:function(e){return'DAB.View.download("'+escape(e)+'")'},doesResourceExist:function(e){var t=escape(e);$.ajax({url:SearchEngine.getConfig("linkStatusUrl")+"&"+SearchEngine.getConfig("linkStatusPortletPrefix")+"urlToCheck="+t,type:"GET",datatype:"JSON",success:function(t){t.length>0&&1==JSON.parse(t)&&LogStore.logResourceError(null,null,e,"Attempting to access resource","Resource not available")},error:function(e){console.log("AJAX request failed.")}})},download:function(e){var t=unescape(e);if(t.indexOf("/dhus/odata/")>=0){var a=SearchEngine.getConfig("proxyUrl")+"&"+SearchEngine.getConfig("proxyPortletPrefix")+"url="+e;if(Liferay.ThemeDisplay.isSignedIn()&&MyWorkspace.Settings.settingsDhusUsername)return DAB.View.doesResourceExist(t),window.open(a);var i=Cookies.get("dhus_username"),r=Cookies.get("dhus_password");i&&r?($(".dhus-download .dhus-username").val(i),$(".dhus-download .dhus-password").val(r),$(".dhus-download button.button_save").prop("disabled",!1)):($(".dhus-download .dhus-username").val(""),$(".dhus-download .dhus-password").val(""),$(".dhus-download button.button_save").prop("disabled",!0)),$(".dhus-download form").attr("action",a),$(".black.dhus-download").show(),DAB.View.doesResourceExist(t)}else window.open(t),DAB.View.doesResourceExist(t)},showMessage:function(e,t){$(".black:visible").find(".close-popup").trigger("click"),$(".black.saved3").find(".title").text(e),$(".black.saved3").find(".title-mode").html(t),$(".black.saved3").show(),$(".black.saved3 .button_saved").focus()},reloadGranulaData:function(){showQueryProgress(),DAB.View.clearPagination(),DAB.Facade.drillDown(DAB.View.drilledDownEntry)},reloadSliders:function(){$("#cloudcp-slider-range").attr("data-value","0-70"),$("#cloudcp-slider-range").slider({range:!0,min:0,max:100,values:[0,70],slide:function(e,t){$("#amount").val("$"+t.values[0]+" - $"+t.values[1]),$("div.box_cloudcp > label").text("Cloud coverage: "+t.values[0]+"-"+t.values[1]+"%")},change:function(e,t){},stop:function(e,t){t.values[0]+"-"+t.values[1]!=$("#cloudcp-slider-range").attr("data-value")&&(DAB.View.reloadGranulaData(),$("#cloudcp-slider-range").attr("data-value",t.values[0]+"-"+t.values[1]))}}),$("#cloudcp").val("$"+$("#cloudcp-slider-range").slider("values",0)+" - $"+$("#cloudcp-slider-range").slider("values",1)),$("div.box_cloudcp > label").text("Cloud coverage: 0-70%")},clearPagination:function(){$(".pagination-container .inside-container").attr("data-search","yes"),$(".pagination-container .inside-container").attr("data-number-page",1),$(".pagination-container .inside-container span.next").removeClass("disabled"),$(".pagination-container .inside-container span.prev").addClass("disabled"),$(".pagination-container .numbers-pagination").text("")},isIrisSearch:function(){return"UUID-e101622c-6ae1-4b68-bfea-8acf067e31dd"==(void 0===searchFormAttributes.queryParams?"":searchFormAttributes.queryParams.value.sources)},initIrisFilters:function(){$(".row-result-form .show-result .iris-filters .single-select").multiselect({onChange:function(e,t,a){""!=$(e).val()?$(e).closest(".iris-filters").addClass("notEmpty"):$(e).closest(".iris-filters").removeClass("notEmpty"),chooseFilteringIcon(),$(".have_to_be").trigger("click"),showQueryProgress(),DAB.Facade.filterQuery(!0)}});$("#mag-slider-range").attr("data-value","0-10"),$("#mag-slider-range").slider({range:!0,min:0,max:10,values:[0,10],slide:function(e,t){$("div.box-mag > span").text("Magnitude limit: "+t.values[0]+"-"+t.values[1])},stop:function(e,t){t.values[0]+"-"+t.values[1]!=$("#mag-slider-range").attr("data-value")&&($("div.box-mag").closest(".iris-filters").addClass("notEmpty"),chooseFilteringIcon(),$(".have_to_be").trigger("click"),showQueryProgress(),DAB.Facade.filterQuery(!0),$("#mag-slider-range").attr("data-value",t.values[0]+"-"+t.values[1]))}}),$("div.box-mag > span").text("Magnitude limit: 0-10");$("#depth-slider-range").attr("data-value","0-100"),$("#depth-slider-range").slider({range:!0,min:0,max:100,values:[0,100],slide:function(e,t){$("div.box-depth > span").text("Depth: "+t.values[0]+"-"+t.values[1]+" KM")},stop:function(e,t){t.values[0]+"-"+t.values[1]!=$("#depth-slider-range").attr("data-value")&&($("div.box-depth").closest(".iris-filters").addClass("notEmpty"),chooseFilteringIcon(),$(".have_to_be").trigger("click"),showQueryProgress(),DAB.Facade.filterQuery(!0),$("#depth-slider-range").attr("data-value",t.values[0]+"-"+t.values[1]))}}),$("div.box-depth > span").text("Depth: 0-100 KM")},showIrisFilters:function(){if($(".iris-filters .multiselect").length||DAB.View.initIrisFilters(),$(".row-result-form .iris-filters").addClass("active"),$(".row-result-form .iris-filters").show(),AOIAction=function(){$(".have_to_be").trigger("click"),showQueryProgress(),DAB.Facade.filterQuery(!0)},$(".row-form-search .date #date-from").val())$(".iris-filters .date #date-from-iris").val($(".row-form-search .date #date-from").val()),irisDateFrom=$(".row-form-search .date #date-from").val();else{var e=DAB.View.getDefaultIrisFromDate();$(".row-form-search .date #date-from").val(e),$(".iris-filters .date #date-from-iris").val(e),irisDateFrom=e}$(".iris-filters .date #date-to-iris").val($(".row-form-search .date #date-to").val()),irisDateTo=$(".row-form-search .date #date-to").val()},hideIrisFilters:function(){if($(".iris-filters .multiselect").length){$(".row-result-form .show-result .iris-filters .single-select").multiselect("select",""),$(".row-result-form .show-result .iris-filters .single-select").multiselect("refresh");$("#mag-slider-range").slider("values",[0,10]),$("#mag-slider-range").attr("data-value","0-10"),$("div.box-mag > span").text("Magnitude limit: 0-10");$("#depth-slider-range").slider("values",[0,100]),$("#depth-slider-range").attr("data-value","0-100"),$("div.box-depth > span").text("Depth: 0-100 KM"),$(".iris-filters .date #date-from-iris").val(""),$(".iris-filters .date #date-to-iris").val(""),irisDateFrom="",irisDateTo=""}$(".row-result-form .iris-filters").removeClass("active"),$(".row-result-form .iris-filters").removeClass("notEmpty").hide()},getDefaultIrisFromDate:function(){var e=new Date;return e.setDate(e.getDate()-30),GeossUtil.formatDate(e)}},DAB.Control={callSearch:function(){DAB.View.clearResults(),DAB.Facade.queryBase()},prepareFacetedQuery:function(){DAB.Control.prepareBaseQuery(readSearchForm(!0))},prepareDrillDownQuery:function(e){var t=DAB.Control.prepareBaseQuery(readSearchForm()).request().setParameter("parents",encodeURIComponent(e)).removeParameter("st"),a=DAB.View.queryablesForEntries[e];if(null!=a&&void 0!=a?(t.setParameter("ts",""),t.setParameter("te",""),DAB.Control.addSateliteTermFrequencyParameter(t,e,a),DAB.Control.addGranulaFiltersToRequest(t,a)):t.removeParameter("tf"),Object.keys(MyWorkspace.Search.filterParams).length>0){var i=Object.keys(MyWorkspace.Search.filterParams);"granula-filters"==MyWorkspace.Search.filterSet&&(i.indexOf("prodType")>=0&&t.setParameter("prodType",MyWorkspace.Search.filterParams.prodType),i.indexOf("sarPolCh")>=0&&t.setParameter("sarPolCh",MyWorkspace.Search.filterParams.sarPolCh),i.indexOf("sensorOpMode")>=0&&t.setParameter("sensorOpMode",MyWorkspace.Search.filterParams.sensorOpMode),i.indexOf("sensorSwath")>=0&&t.setParameter("sensorSwath",MyWorkspace.Search.filterParams.sensorSwath),i.indexOf("relOrbit")>=0&&t.setParameter("relOrbit",MyWorkspace.Search.filterParams.relOrbit),i.indexOf("row")>=0&&t.setParameter("row",MyWorkspace.Search.filterParams.row),i.indexOf("path")>=0&&t.setParameter("path",MyWorkspace.Search.filterParams.path),i.indexOf("cloudcp")>=0&&t.setParameter("cloudcp",MyWorkspace.Search.filterParams.cloudcp),i.indexOf("dateFromGranula")>=0&&t.setParameter("ts",MyWorkspace.Search.filterParams.dateFromGranula),i.indexOf("dateToGranula")>=0&&t.setParameter("te",MyWorkspace.Search.filterParams.dateToGranula))}return t},prepareBaseQuery:function(e){var t=new DAB.Client.SimpleXmlRequest(e.query);return e.viewid&&t.request().setParameter("viewid",e.viewid),e.ts&&t.request().setParameter("ts",e.ts),e.te&&t.request().setParameter("te",e.te),e.gdc&&t.request().setParameter("gdc",e.gdc),e.bbox&&t.request().setParameter("bbox",e.bbox),e.w3w&&t.request().setParameter("w3w",e.w3w),e.rel&&t.request().setParameter("rel",e.rel),e.magt&&t.request().setParameter("magt",e.magt),e.evtOrd&&t.request().setParameter("evtOrd",e.evtOrd),e.minmag&&t.request().setParameter("minmag",e.minmag),e.maxmag&&t.request().setParameter("maxmag",e.maxmag),e.mind&&t.request().setParameter("mind",e.mind),e.maxd&&t.request().setParameter("maxd",e.maxd),e.kwd&&t.request().setParameter("kwd",e.kwd),e.frmt&&t.request().setParameter("frmt",e.frmt),e.sources&&t.request().setParameter("sources",e.sources),e.prot&&t.request().setParameter("prot",e.prot),e.organisationName&&t.request().setParameter("organisationName",e.organisationName),e.si&&t.request().setParameter("si",e.si),t},addSateliteTermFrequencyParameter:function(e,t,a){var i="",r=!0;a.split(",").filter(function(e){return void 0!=DAB.View.enumGranulaFilterLabels[e]}).forEach(function(e){r||(i+=","),i+=e,r=!1}),e.setParameter("tf",i)},addGranulaFiltersToRequest:function(e,t){t.split(",").forEach(function(t){DAB.Control.tryToAddEnumGranulaFilterToRequest(t,e),DAB.Control.tryToAddContinousGranulaFilterToRequest(t,e),DAB.Control.tryToAddIntegerGranulaFilterToRequest(t,e)});var a=$(".granula-filters .date #date-from-granula").val();a&&e.setParameter("ts",a);var i=$(".granula-filters .date #date-to-granula").val();i&&e.setParameter("te",i)},tryToAddIntegerGranulaFilterToRequest:function(e,t){var a=$("#filter-"+e).val();void 0!=a&&null!=a&&t.setParameter(e,a)},tryToAddEnumGranulaFilterToRequest:function(e,t){var a=$(".granula-filters ."+e+"-select .active input").attr("value");void 0!=a&&null!=a&&t.setParameter(e,a)},tryToAddContinousGranulaFilterToRequest:function(e,t){try{var a=$("#"+e+"-slider-range").slider("values");if(null!=a&&2==a.length){var i=a[0],r=a[1];t.setParameter(e,"["+i+","+r+"]")}}catch(e){throw e}},prepareSingleResultQuery:function(e){return new DAB.Client.SingleResultXmlRequest(e)}},satelliteParamsForRBox=["acquisition platform","acquisition platformid","acquisition productType","gmd\\:distributionInfo gmd\\:transferSize gco\\:Real","acquisition instrument","acquisition relativeOrbit","acquisition cloud_cover_percentage","acquisition row","acquisition path","acquisition instrumentSwath","acquisition sensorPolarisation","acquisition acquisitiontype","acquisition missiondatatakeid","acquisition startOrbitNumber","acquisition stopOrbitNumber","acquisition orbitdirection","acquisition productclass","acquisition productconsolidation","acquisition stopRelativeOrbitNumber","acquisition slicenumber","acquisition status","acquisition processingbaseline","acquisition processinglevel","dtstart","dtstop"];var satelliteParamsForRBoxParams={"acquisition platform":["Platform",!0,!0,!0,null,null],"acquisition platformid":["Platform Id",!1,!0,!0,null,null],"acquisition productType":["Product type",!0,!0,!0,null,null],"gmd\\:distributionInfo gmd\\:transferSize gco\\:Real":["Size",!0,!0,!1,null,DAB.View.roundSizeMB],"acquisition instrument":["Instrument",!0,!0,!0,null,null],"acquisition relativeOrbit":["Relative orbit",!0,!0,!1,null,null],"acquisition cloud_cover_percentage":["Cloud coverage",!0,!0,!0,null,null],"acquisition row":["Row",!0,!1,!0,null,null],"acquisition path":["Path",!0,!1,!0,null,null],"acquisition instrumentSwath":["Instrument swath",!1,!0,!1,null,null],"acquisition sensorPolarisation":["Sensor polarisation",!1,!0,!1,null,null],"acquisition acquisitiontype":["Aquisition type",!1,!0,!1,null,null],"acquisition missiondatatakeid":["Mission data taken",!1,!0,!1,null,null],"acquisition startOrbitNumber":["Start orbit number",!1,!0,!1,null,null],"acquisition stopOrbitNumber":["Stop orbit number",!1,!0,!1,null,null],"acquisition orbitdirection":["Orbit direction",!1,!0,!1,null,null],"acquisition productclass":["Product class",!1,!0,!1,null,null],"acquisition productconsolidation":["Product consolidation",!1,!0,!1,null,null],"acquisition stopRelativeOrbitNumber":["Stop Relative orbit number",!1,!0,!1,null,null],"acquisition slicenumber":["Slice number",!1,!0,!1,null,null],"acquisition status":["Status",!1,!0,!1,null,null],"acquisition processingbaseline":["Processing baseline",!1,!0,!1,null,null],"acquisition processinglevel":["Processing level",!1,!0,!1,null,null],dtstart:["Daytime start",!0,!0,!0,"Collection start date",DAB.View.extractDate],dtstop:["Daytime stop",!0,!0,!0,"Collection stop date",DAB.View.extractDate]};DAB.Facade={view:DAB.View,control:DAB.Control,queryBase:function(){try{DAB.Client.callOpenSearch(DAB.Facade.control.prepareBaseQuery(readSearchForm()),DAB.Facade.view.presentMainResults,successResponse,failureResponse)}catch(e){console.error(e),LogStore.logResourceError("opensearch",null,null,null)}},drillDown:function(e){DAB.Client.callOpenSearch(DAB.Facade.control.prepareDrillDownQuery(e),DAB.Facade.view.presentDrillDownResults,successResponse,failureResponse)},filterQuery:function(e){DAB.Client.callOpenSearch(DAB.Facade.control.prepareBaseQuery(readSearchForm(!0,e)),DAB.Facade.view.presentMainResults,successResponse,failureResponse)},querySingleResult:function(e){DAB.View.clearResults(),DAB.Client.callOpenSearch(DAB.Facade.control.prepareSingleResultQuery(e),DAB.Facade.view.presentMainResults,successResponse,failureResponse)},getMetadata:function(e){DAB.Client.getMetadata(e,DAB.Facade.view.presentMetadata)}};var Geoss={resultsContainer:".wrap-result-list .result-rows",init:function(){},search:function(e,t,a){DAB.Client.callOpenSearch(DAB.Facade.control.prepareBaseQuery(e),DAB.Facade.view.presentMainResults,t,a)}};